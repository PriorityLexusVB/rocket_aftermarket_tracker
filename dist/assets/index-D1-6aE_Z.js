import{j as e,X as xe,U as te,M as he,P as pe,n as ie,W as ce,$ as je,F as re,q as ye,a9 as E,w as ue,r as L,G as $,Z as Q,D as ge,K as Ne,N as be,ac as F,a3 as ve}from"./index-CcC1YCBr.js";import{r as x}from"./react-Czq5O75u.js";import{c as X}from"./claimsService-D015U25r.js";import{A as oe}from"./AppLayout-MUpzdxt6.js";import"./supabase-D02rA7zj.js";import"./router-CZES1Sa0.js";import"./Navbar-C3SUqvwP.js";const fe=({claim:s,staff:h,onClose:u,onUpdate:m})=>{var R,P,B,S,Z,D,I,z,V;const[n,i]=x.useState({status:(s==null?void 0:s.status)||"submitted",priority:(s==null?void 0:s.priority)||"medium",assigned_to:(s==null?void 0:s.assigned_to)||"",resolution_notes:(s==null?void 0:s.resolution_notes)||"",claim_amount:(s==null?void 0:s.claim_amount)||""}),[c,k]=x.useState([]),[M,v]=x.useState(!0),[a,p]=x.useState(!1),[A,w]=x.useState(null);x.useEffect(()=>{s!=null&&s.id&&Y()},[s==null?void 0:s.id]);const Y=async()=>{var t;try{v(!0);const y=await((t=X)==null?void 0:t.getClaimAttachments(s==null?void 0:s.id));k(y||[])}catch(y){console.error("Error loading attachments:",y)}finally{v(!1)}},_=t=>{const{name:y,value:ee}=t==null?void 0:t.target;i(J=>({...J,[y]:ee}))},g=async()=>{try{p(!0),w(null);const t={...n,claim_amount:n!=null&&n.claim_amount?parseFloat(n==null?void 0:n.claim_amount):null};await m(s==null?void 0:s.id,t),u()}catch(t){w(t==null?void 0:t.message)}finally{p(!1)}},G=t=>{switch(t){case"submitted":return e.jsx(L,{className:"w-4 h-4 text-blue-500"});case"under_review":return e.jsx(E,{className:"w-4 h-4 text-yellow-500"});case"approved":return e.jsx($,{className:"w-4 h-4 text-green-500"});case"denied":return e.jsx(Q,{className:"w-4 h-4 text-red-500"});case"resolved":return e.jsx($,{className:"w-4 h-4 text-gray-500"});default:return e.jsx(L,{className:"w-4 h-4 text-gray-500"})}},O=t=>{switch(t){case"submitted":return"bg-blue-100 text-blue-800";case"under_review":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"denied":return"bg-red-100 text-red-800";case"resolved":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},K=t=>{switch(t){case"urgent":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},C=t=>{var y;return t?(y=new Date(t))==null?void 0:y.toLocaleString():"N/A"};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-6xl w-full max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${K(s==null?void 0:s.priority)}`}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s==null?void 0:s.claim_number}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[G(s==null?void 0:s.status),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${O(s==null?void 0:s.status)}`,children:(P=(R=s==null?void 0:s.status)==null?void 0:R.replace("_"," "))==null?void 0:P.toUpperCase()})]})]})]}),e.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(xe,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-180px)]",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 p-6",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),"Customer Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Name:"}),e.jsx("p",{className:"text-gray-600",children:(s==null?void 0:s.customer_name)||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Email:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-gray-600",children:(s==null?void 0:s.customer_email)||"N/A"}),(s==null?void 0:s.customer_email)&&e.jsx("a",{href:`mailto:${s==null?void 0:s.customer_email}`,className:"text-blue-600 hover:text-blue-700",children:e.jsx(he,{className:"w-3 h-3"})})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-700",children:"Phone:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("p",{className:"text-gray-600",children:(s==null?void 0:s.customer_phone)||"N/A"}),(s==null?void 0:s.customer_phone)&&e.jsx("a",{href:`tel:${s==null?void 0:s.customer_phone}`,className:"text-blue-600 hover:text-blue-700",children:e.jsx(pe,{className:"w-3 h-3"})})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(s==null?void 0:s.vehicle)&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4"}),"Vehicle"]}),e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Vehicle:"})," ",(B=s==null?void 0:s.vehicle)==null?void 0:B.year," ",(S=s==null?void 0:s.vehicle)==null?void 0:S.make," ",(Z=s==null?void 0:s.vehicle)==null?void 0:Z.model]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Owner:"})," ",(D=s==null?void 0:s.vehicle)==null?void 0:D.owner_name]})]})]}),(s==null?void 0:s.product)&&e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4"}),"Product"]}),e.jsxs("div",{className:"text-sm space-y-2",children:[e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Product:"})," ",(I=s==null?void 0:s.product)==null?void 0:I.name]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Brand:"})," ",(z=s==null?void 0:s.product)==null?void 0:z.brand]}),e.jsxs("p",{children:[e.jsx("span",{className:"font-medium",children:"Category:"})," ",(V=s==null?void 0:s.product)==null?void 0:V.category]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(je,{className:"w-4 h-4"}),"Issue Description"]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:(s==null?void 0:s.issue_description)||"No description provided"})})]}),(s==null?void 0:s.preferred_resolution)&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-3",children:"Preferred Resolution"}),e.jsx("div",{className:"bg-blue-50 rounded-lg p-4",children:e.jsx("p",{className:"text-gray-700 whitespace-pre-wrap",children:s==null?void 0:s.preferred_resolution})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(re,{className:"w-4 h-4"}),"Attachments",M&&e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})]}),(c==null?void 0:c.length)===0?e.jsxs("div",{className:"text-center py-8 bg-gray-50 rounded-lg",children:[e.jsx(re,{className:"w-12 h-12 text-gray-300 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"No attachments uploaded"})]}):e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:c==null?void 0:c.map(t=>{var y;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 truncate",children:t==null?void 0:t.file_name}),(t==null?void 0:t.signedUrl)&&e.jsx("a",{href:t==null?void 0:t.signedUrl,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-700 text-sm",children:"View"})]}),(t==null?void 0:t.description)&&e.jsx("p",{className:"text-xs text-gray-500 mb-2",children:t==null?void 0:t.description}),(t==null?void 0:t.signedUrl)&&((y=t==null?void 0:t.file_type)==null?void 0:y.startsWith("image/"))&&e.jsx("img",{src:t==null?void 0:t.signedUrl,alt:(t==null?void 0:t.description)||(t==null?void 0:t.file_name),className:"w-full h-32 object-cover rounded border"})]},t==null?void 0:t.id)})})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("h3",{className:"font-medium text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(ye,{className:"w-4 h-4"}),"Timeline"]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Submitted:"}),e.jsx("span",{className:"text-gray-900",children:C(s==null?void 0:s.created_at)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Last Updated:"}),e.jsx("span",{className:"text-gray-900",children:C(s==null?void 0:s.updated_at)})]}),(s==null?void 0:s.resolved_at)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Resolved:"}),e.jsx("span",{className:"text-gray-900",children:C(s==null?void 0:s.resolved_at)})]})]})]}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Processing Actions"}),A&&e.jsxs("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-lg p-3 flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700 text-sm",children:A})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{name:"status",value:n==null?void 0:n.status,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"under_review",children:"Under Review"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"denied",children:"Denied"}),e.jsx("option",{value:"resolved",children:"Resolved"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),e.jsxs("select",{name:"priority",value:n==null?void 0:n.priority,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[e.jsx("option",{value:"low",children:"Low"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"urgent",children:"Urgent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign To"}),e.jsxs("select",{name:"assigned_to",value:n==null?void 0:n.assigned_to,onChange:_,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",children:[e.jsx("option",{value:"",children:"Unassigned"}),h==null?void 0:h.map(t=>e.jsxs("option",{value:t==null?void 0:t.id,children:[t==null?void 0:t.full_name," (",t==null?void 0:t.role,")"]},t==null?void 0:t.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Claim Amount"}),e.jsx("input",{type:"number",name:"claim_amount",value:n==null?void 0:n.claim_amount,onChange:_,min:"0",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Resolution Notes"}),e.jsx("textarea",{name:"resolution_notes",value:n==null?void 0:n.resolution_notes,onChange:_,rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm",placeholder:"Add notes about the resolution..."})]})]})]})]})]})}),e.jsxs("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-600",children:["Last updated: ",C(s==null?void 0:s.updated_at)]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:g,disabled:a,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-colors",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"w-4 h-4"}),"Save Changes"]})})]})]})]})})},we=({stats:s})=>{var m,n;if(!s)return null;const h=i=>{switch(i){case"submitted":return e.jsx(L,{className:"w-5 h-5 text-blue-500"});case"under_review":return e.jsx(E,{className:"w-5 h-5 text-yellow-500"});case"approved":return e.jsx($,{className:"w-5 h-5 text-green-500"});case"denied":return e.jsx(Q,{className:"w-5 h-5 text-red-500"});case"resolved":return e.jsx($,{className:"w-5 h-5 text-gray-500"});default:return e.jsx(L,{className:"w-5 h-5 text-gray-500"})}},u=i=>{var c;return(c=new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}))==null?void 0:c.format(i||0)};return e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Claims"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:s==null?void 0:s.total})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(L,{className:"w-6 h-6 text-blue-600"})})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("span",{className:"text-sm text-gray-600",children:[s==null?void 0:s.recentClaims," new in last 30 days"]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Amount"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:u(s==null?void 0:s.totalAmount)})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(ge,{className:"w-6 h-6 text-green-600"})})]}),e.jsx("div",{className:"mt-4",children:e.jsxs("span",{className:"text-sm text-gray-600",children:["Avg: ",u(s==null?void 0:s.avgAmount)]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"By Status"}),e.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:e.jsx(Ne,{className:"w-4 h-4 text-yellow-600"})})]}),e.jsx("div",{className:"space-y-2",children:(m=Object.entries((s==null?void 0:s.byStatus)||{}))==null?void 0:m.map(([i,c])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[h(i),e.jsx("span",{className:"text-sm text-gray-700 capitalize",children:i==null?void 0:i.replace("_"," ")})]}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:c})]},i))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"By Priority"}),e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(E,{className:"w-4 h-4 text-red-600"})})]}),e.jsx("div",{className:"space-y-2",children:(n=Object.entries((s==null?void 0:s.byPriority)||{}))==null?void 0:n.map(([i,c])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${me(i)}`}),e.jsx("span",{className:"text-sm text-gray-700 capitalize",children:i})]}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:c})]},i))})]})]})},me=s=>{switch(s){case"urgent":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},_e=({claim:s,staff:h,onClose:u,onUpdate:m})=>{var v;const[n,i]=x.useState((s==null?void 0:s.assigned_to)||""),[c,k]=x.useState(!1),M=async()=>{try{k(!0),await m(s==null?void 0:s.id,{assigned_to:n||null}),u()}catch(a){console.error("Error assigning claim:",a)}finally{k(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-xl shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(te,{className:"w-5 h-5 text-gray-600"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Assign Claim"})]}),e.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(xe,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Claim: ",e.jsx("span",{className:"font-medium text-gray-900",children:s==null?void 0:s.claim_number})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Customer: ",e.jsx("span",{className:"font-medium text-gray-900",children:s==null?void 0:s.customer_name})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign to staff member"}),e.jsxs("select",{value:n,onChange:a=>{var p;return i((p=a==null?void 0:a.target)==null?void 0:p.value)},className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Unassigned"}),h==null?void 0:h.map(a=>{var p,A,w;return e.jsxs("option",{value:a==null?void 0:a.id,children:[a==null?void 0:a.full_name," - ",((A=(p=a==null?void 0:a.role)==null?void 0:p.charAt(0))==null?void 0:A.toUpperCase())+((w=a==null?void 0:a.role)==null?void 0:w.slice(1))]},a==null?void 0:a.id)})]})]}),n&&e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-700",children:["This claim will be assigned to"," ",e.jsx("span",{className:"font-medium",children:(v=h==null?void 0:h.find(a=>(a==null?void 0:a.id)===n))==null?void 0:v.full_name})]})})]}),e.jsxs("div",{className:"p-6 border-t border-gray-200 flex items-center justify-end gap-3",children:[e.jsx("button",{onClick:u,className:"px-4 py-2 text-gray-600 bg-gray-100 rounded-lg hover:bg-gray-200 transition-colors",children:"Cancel"}),e.jsx("button",{onClick:M,disabled:c,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 transition-colors",children:c?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Assigning..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ue,{className:"w-4 h-4"}),"Assign Claim"]})})]})]})})},Le=()=>{var ne,ae;const[s,h]=x.useState([]),[u,m]=x.useState([]),[n,i]=x.useState(null),[c,k]=x.useState(!0),[M,v]=x.useState(null),[a,p]=x.useState(null),[A,w]=x.useState(!1),[Y,_]=x.useState(!1),[g,G]=x.useState(""),[O,K]=x.useState("all"),[C,R]=x.useState("all"),[P,B]=x.useState("all"),[S,Z]=x.useState("created_at"),[D,I]=x.useState("desc");x.useEffect(()=>{z()},[]);const z=async()=>{var r,d,o;try{k(!0),v(null);const[l,N,j]=await Promise.all([(r=X)==null?void 0:r.getAllClaims(),(d=X)==null?void 0:d.getStaff(),(o=X)==null?void 0:o.getClaimsStats()]);h(l||[]),m(N||[]),i(j)}catch(l){v(l==null?void 0:l.message)}finally{k(!1)}},V=async(r,d)=>{var o;try{const l=await((o=X)==null?void 0:o.updateClaim(r,d));h(N=>N==null?void 0:N.map(j=>(j==null?void 0:j.id)===r?l:j)),p(l)}catch(l){v(`Failed to update claim: ${l==null?void 0:l.message}`)}},t=r=>{switch(r){case"submitted":return e.jsx(L,{className:"w-4 h-4 text-blue-500"});case"under_review":return e.jsx(E,{className:"w-4 h-4 text-yellow-500"});case"approved":return e.jsx($,{className:"w-4 h-4 text-green-500"});case"denied":return e.jsx(Q,{className:"w-4 h-4 text-red-500"});case"resolved":return e.jsx($,{className:"w-4 h-4 text-gray-500"});default:return e.jsx(L,{className:"w-4 h-4 text-gray-500"})}},y=r=>{switch(r){case"submitted":return"bg-blue-100 text-blue-800";case"under_review":return"bg-yellow-100 text-yellow-800";case"approved":return"bg-green-100 text-green-800";case"denied":return"bg-red-100 text-red-800";case"resolved":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},ee=r=>{switch(r){case"urgent":return"bg-red-500";case"high":return"bg-orange-500";case"medium":return"bg-yellow-500";case"low":return"bg-green-500";default:return"bg-gray-500"}},J=r=>Math.floor((new Date-new Date(r))/864e5),se=r=>J(r==null?void 0:r.created_at)>7&&["submitted","under_review"].includes(r==null?void 0:r.status),b=((ne=s==null?void 0:s.filter(r=>{var j,W,q,H,T,f,de,le;const d=g===""||((W=(j=r==null?void 0:r.claim_number)==null?void 0:j.toLowerCase())==null?void 0:W.includes(g==null?void 0:g.toLowerCase()))||((H=(q=r==null?void 0:r.customer_name)==null?void 0:q.toLowerCase())==null?void 0:H.includes(g==null?void 0:g.toLowerCase()))||((f=(T=r==null?void 0:r.customer_email)==null?void 0:T.toLowerCase())==null?void 0:f.includes(g==null?void 0:g.toLowerCase()))||((le=(de=r==null?void 0:r.issue_description)==null?void 0:de.toLowerCase())==null?void 0:le.includes(g==null?void 0:g.toLowerCase())),o=O==="all"||(r==null?void 0:r.status)===O,l=C==="all"||(r==null?void 0:r.priority)===C,N=P==="all"||P==="unassigned"&&!(r!=null&&r.assigned_to)||(r==null?void 0:r.assigned_to)===P;return d&&o&&l&&N}))==null?void 0:ne.sort((r,d)=>{var N,j;let o=r==null?void 0:r[S],l=d==null?void 0:d[S];return S==="customer_name"?(o=(r==null?void 0:r.customer_name)||"",l=(d==null?void 0:d.customer_name)||""):S==="assigned_to_name"&&(o=((N=r==null?void 0:r.assigned_to_profile)==null?void 0:N.full_name)||"",l=((j=d==null?void 0:d.assigned_to_profile)==null?void 0:j.full_name)||""),typeof o=="string"?D==="asc"?o==null?void 0:o.localeCompare(l):l==null?void 0:l.localeCompare(o):((o instanceof Date||typeof o=="string")&&(o=new Date(o),l=new Date(l)),D==="asc"?o-l:l-o)}))||[],U=r=>{S===r?I(D==="asc"?"desc":"asc"):(Z(r),I("asc"))};return c?e.jsx(oe,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading claims management center..."})]})})}):e.jsx(oe,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm border-b",children:e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Claims Management Center"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Process, review, and resolve customer warranty claims"})]}),e.jsx("div",{className:"flex items-center gap-3",children:e.jsx("button",{onClick:z,className:"px-4 py-2 text-gray-600 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors",children:"Refresh"})})]})})}),M&&e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-center gap-3",children:[e.jsx(E,{className:"w-5 h-5 text-red-500 flex-shrink-0"}),e.jsx("p",{className:"text-red-700",children:M}),e.jsx("button",{onClick:()=>v(null),className:"ml-auto text-red-500 hover:text-red-700",children:e.jsx(Q,{className:"w-5 h-5"})})]})}),e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[n&&e.jsx(we,{stats:n}),e.jsxs("div",{className:"mt-8 bg-white rounded-xl shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(be,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:"Search claims by number, customer, or description...",value:g,onChange:r=>{var d;return G((d=r==null?void 0:r.target)==null?void 0:d.value)},className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("select",{value:O,onChange:r=>{var d;return K((d=r==null?void 0:r.target)==null?void 0:d.value)},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"submitted",children:"Submitted"}),e.jsx("option",{value:"under_review",children:"Under Review"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"denied",children:"Denied"}),e.jsx("option",{value:"resolved",children:"Resolved"})]}),e.jsxs("select",{value:C,onChange:r=>{var d;return R((d=r==null?void 0:r.target)==null?void 0:d.value)},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Priority"}),e.jsx("option",{value:"urgent",children:"Urgent"}),e.jsx("option",{value:"high",children:"High"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"low",children:"Low"})]}),e.jsxs("select",{value:P,onChange:r=>{var d;return B((d=r==null?void 0:r.target)==null?void 0:d.value)},className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"All Assignees"}),e.jsx("option",{value:"unassigned",children:"Unassigned"}),u==null?void 0:u.map(r=>e.jsx("option",{value:r==null?void 0:r.id,children:r==null?void 0:r.full_name},r==null?void 0:r.id))]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",(b==null?void 0:b.length)||0," of ",(s==null?void 0:s.length)||0," claims"]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[((ae=b==null?void 0:b.filter(r=>se(r)))==null?void 0:ae.length)||0," overdue claims"]})]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsxs("button",{onClick:()=>U("claim_number"),className:"flex items-center gap-1 text-xs font-medium text-gray-500 uppercase tracking-wider hover:text-gray-700",children:["Claim #",e.jsx(F,{className:"w-3 h-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsxs("button",{onClick:()=>U("customer_name"),className:"flex items-center gap-1 text-xs font-medium text-gray-500 uppercase tracking-wider hover:text-gray-700",children:["Customer",e.jsx(F,{className:"w-3 h-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Vehicle/Product"}),e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsxs("button",{onClick:()=>U("status"),className:"flex items-center gap-1 text-xs font-medium text-gray-500 uppercase tracking-wider hover:text-gray-700",children:["Status",e.jsx(F,{className:"w-3 h-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsxs("button",{onClick:()=>U("priority"),className:"flex items-center gap-1 text-xs font-medium text-gray-500 uppercase tracking-wider hover:text-gray-700",children:["Priority",e.jsx(F,{className:"w-3 h-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsxs("button",{onClick:()=>U("claim_amount"),className:"flex items-center gap-1 text-xs font-medium text-gray-500 uppercase tracking-wider hover:text-gray-700",children:["Amount",e.jsx(F,{className:"w-3 h-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsxs("button",{onClick:()=>U("assigned_to_name"),className:"flex items-center gap-1 text-xs font-medium text-gray-500 uppercase tracking-wider hover:text-gray-700",children:["Assigned To",e.jsx(F,{className:"w-3 h-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left",children:e.jsxs("button",{onClick:()=>U("created_at"),className:"flex items-center gap-1 text-xs font-medium text-gray-500 uppercase tracking-wider hover:text-gray-700",children:["Created",e.jsx(F,{className:"w-3 h-3"})]})}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:b==null?void 0:b.map(r=>{var d,o,l,N,j,W,q,H,T;return e.jsxs("tr",{className:`hover:bg-gray-50 cursor-pointer ${se(r)?"bg-red-50":""}`,onClick:()=>{p(r),w(!0)},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[se(r)&&e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full animate-pulse"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:r==null?void 0:r.claim_number})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:r==null?void 0:r.customer_name}),e.jsx("div",{className:"text-sm text-gray-500",children:r==null?void 0:r.customer_email})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm",children:[(r==null?void 0:r.vehicle)&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3 text-gray-400"}),e.jsxs("span",{className:"text-gray-900",children:[(d=r==null?void 0:r.vehicle)==null?void 0:d.year," ",(o=r==null?void 0:r.vehicle)==null?void 0:o.make," ",(l=r==null?void 0:r.vehicle)==null?void 0:l.model]})]}),(r==null?void 0:r.product)&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ce,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-gray-900",children:(N=r==null?void 0:r.product)==null?void 0:N.name})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[t(r==null?void 0:r.status),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${y(r==null?void 0:r.status)}`,children:(W=(j=r==null?void 0:r.status)==null?void 0:j.replace("_"," "))==null?void 0:W.toUpperCase()})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${ee(r==null?void 0:r.priority)}`}),e.jsx("span",{className:"text-sm text-gray-900 capitalize",children:r==null?void 0:r.priority})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(ge,{className:"w-3 h-3 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-900",children:r!=null&&r.claim_amount?(q=parseFloat(r==null?void 0:r.claim_amount))==null?void 0:q.toFixed(2):"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("div",{className:"text-sm text-gray-900",children:((H=r==null?void 0:r.assigned_to_profile)==null?void 0:H.full_name)||e.jsx("span",{className:"text-gray-400 italic",children:"Unassigned"})})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:(T=new Date(r==null?void 0:r.created_at))==null?void 0:T.toLocaleDateString()}),e.jsxs("div",{className:"text-xs text-gray-500",children:[J(r==null?void 0:r.created_at)," days ago"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:f=>{f==null||f.stopPropagation(),p(r),_(!0)},className:"text-blue-600 hover:text-blue-900",title:"Assign",children:e.jsx(te,{className:"w-4 h-4"})}),e.jsx("button",{onClick:f=>{f==null||f.stopPropagation(),p(r),w(!0)},className:"text-gray-600 hover:text-gray-900",title:"View Details",children:e.jsx(ve,{className:"w-4 h-4"})})]})})]},r==null?void 0:r.id)})})]}),(b==null?void 0:b.length)===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(re,{className:"w-8 h-8 text-gray-400"})}),e.jsx("p",{className:"text-gray-500 mb-4",children:"No claims found matching your filters"}),e.jsx("button",{onClick:()=>{G(""),K("all"),R("all"),B("all")},className:"text-blue-600 hover:text-blue-700 font-medium",children:"Clear all filters"})]})]})]})]}),A&&a&&e.jsx(fe,{claim:a,staff:u,onClose:()=>{w(!1),p(null)},onUpdate:V}),Y&&a&&e.jsx(_e,{claim:a,staff:u,onClose:()=>{_(!1),p(null)},onUpdate:V})]})})};export{Le as default};
//# sourceMappingURL=index-D1-6aE_Z.js.map
