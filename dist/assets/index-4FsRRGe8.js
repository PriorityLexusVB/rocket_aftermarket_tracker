import{j as e,ac as Je,a5 as Zt,B as Y,_ as Br,x as Dr,Z as Lr,ad as Ir,u as Ur,s as P,R as $r,ae as qr,y as zr,af as ue,N as Vr,W as Or,h as H,ag as Ue,ah as $e,ai as qe}from"./index-bKsQOSUW.js";import{r as L}from"./react-Czq5O75u.js";import{u as Qr}from"./useTenant-BvYf0MSW.js";import{A as ot}from"./AppLayout-Ce8nRdhb.js";import{u as Gr}from"./useLogger-CWaxYXXh.js";import"./supabase-D02rA7zj.js";import"./router-CZES1Sa0.js";import"./Navbar-DMaqRiFJ.js";var ye={},Hr=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},Xt={},te={};let yt;const Kr=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];te.getSymbolSize=function(s){if(!s)throw new Error('"version" cannot be null or undefined');if(s<1||s>40)throw new Error('"version" should be in range from 1 to 40');return s*4+17};te.getSymbolTotalCodewords=function(s){return Kr[s]};te.getBCHDigit=function(n){let s=0;for(;n!==0;)s++,n>>>=1;return s};te.setToSJISFunction=function(s){if(typeof s!="function")throw new Error('"toSJISFunc" is not a valid function.');yt=s};te.isKanjiModeEnabled=function(){return typeof yt<"u"};te.toSJIS=function(s){return yt(s)};var Ze={};(function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function s(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+o)}}n.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},n.from=function(r,i){if(n.isValid(r))return r;try{return s(r)}catch{return i}}})(Ze);function Ft(){this.buffer=[],this.length=0}Ft.prototype={get:function(n){const s=Math.floor(n/8);return(this.buffer[s]>>>7-n%8&1)===1},put:function(n,s){for(let o=0;o<s;o++)this.putBit((n>>>s-o-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const s=Math.floor(this.length/8);this.buffer.length<=s&&this.buffer.push(0),n&&(this.buffer[s]|=128>>>this.length%8),this.length++}};var Jr=Ft;function Oe(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}Oe.prototype.set=function(n,s,o,r){const i=n*this.size+s;this.data[i]=o,r&&(this.reservedBit[i]=!0)};Oe.prototype.get=function(n,s){return this.data[n*this.size+s]};Oe.prototype.xor=function(n,s,o){this.data[n*this.size+s]^=o};Oe.prototype.isReserved=function(n,s){return this.reservedBit[n*this.size+s]};var Yr=Oe,er={};(function(n){const s=te.getSymbolSize;n.getRowColCoords=function(r){if(r===1)return[];const i=Math.floor(r/7)+2,l=s(r),c=l===145?26:Math.ceil((l-13)/(2*i-2))*2,g=[l-7];for(let h=1;h<i-1;h++)g[h]=g[h-1]-c;return g.push(6),g.reverse()},n.getPositions=function(r){const i=[],l=n.getRowColCoords(r),c=l.length;for(let g=0;g<c;g++)for(let h=0;h<c;h++)g===0&&h===0||g===0&&h===c-1||g===c-1&&h===0||i.push([l[g],l[h]]);return i}})(er);var tr={};const Wr=te.getSymbolSize,Jt=7;tr.getPositions=function(s){const o=Wr(s);return[[0,0],[o-Jt,0],[0,o-Jt]]};var rr={};(function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const s={N1:3,N2:3,N3:40,N4:10};n.isValid=function(i){return i!=null&&i!==""&&!isNaN(i)&&i>=0&&i<=7},n.from=function(i){return n.isValid(i)?parseInt(i,10):void 0},n.getPenaltyN1=function(i){const l=i.size;let c=0,g=0,h=0,w=null,f=null;for(let U=0;U<l;U++){g=h=0,w=f=null;for(let j=0;j<l;j++){let b=i.get(U,j);b===w?g++:(g>=5&&(c+=s.N1+(g-5)),w=b,g=1),b=i.get(j,U),b===f?h++:(h>=5&&(c+=s.N1+(h-5)),f=b,h=1)}g>=5&&(c+=s.N1+(g-5)),h>=5&&(c+=s.N1+(h-5))}return c},n.getPenaltyN2=function(i){const l=i.size;let c=0;for(let g=0;g<l-1;g++)for(let h=0;h<l-1;h++){const w=i.get(g,h)+i.get(g,h+1)+i.get(g+1,h)+i.get(g+1,h+1);(w===4||w===0)&&c++}return c*s.N2},n.getPenaltyN3=function(i){const l=i.size;let c=0,g=0,h=0;for(let w=0;w<l;w++){g=h=0;for(let f=0;f<l;f++)g=g<<1&2047|i.get(w,f),f>=10&&(g===1488||g===93)&&c++,h=h<<1&2047|i.get(f,w),f>=10&&(h===1488||h===93)&&c++}return c*s.N3},n.getPenaltyN4=function(i){let l=0;const c=i.data.length;for(let h=0;h<c;h++)l+=i.data[h];return Math.abs(Math.ceil(l*100/c/5)-10)*s.N4};function o(r,i,l){switch(r){case n.Patterns.PATTERN000:return(i+l)%2===0;case n.Patterns.PATTERN001:return i%2===0;case n.Patterns.PATTERN010:return l%3===0;case n.Patterns.PATTERN011:return(i+l)%3===0;case n.Patterns.PATTERN100:return(Math.floor(i/2)+Math.floor(l/3))%2===0;case n.Patterns.PATTERN101:return i*l%2+i*l%3===0;case n.Patterns.PATTERN110:return(i*l%2+i*l%3)%2===0;case n.Patterns.PATTERN111:return(i*l%3+(i+l)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}n.applyMask=function(i,l){const c=l.size;for(let g=0;g<c;g++)for(let h=0;h<c;h++)l.isReserved(h,g)||l.xor(h,g,o(i,h,g))},n.getBestMask=function(i,l){const c=Object.keys(n.Patterns).length;let g=0,h=1/0;for(let w=0;w<c;w++){l(w),n.applyMask(w,i);const f=n.getPenaltyN1(i)+n.getPenaltyN2(i)+n.getPenaltyN3(i)+n.getPenaltyN4(i);n.applyMask(w,i),f<h&&(h=f,g=w)}return g}})(rr);var Xe={};const me=Ze,He=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Ke=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Xe.getBlocksCount=function(s,o){switch(o){case me.L:return He[(s-1)*4+0];case me.M:return He[(s-1)*4+1];case me.Q:return He[(s-1)*4+2];case me.H:return He[(s-1)*4+3];default:return}};Xe.getTotalCodewordsCount=function(s,o){switch(o){case me.L:return Ke[(s-1)*4+0];case me.M:return Ke[(s-1)*4+1];case me.Q:return Ke[(s-1)*4+2];case me.H:return Ke[(s-1)*4+3];default:return}};var sr={},Fe={};const ze=new Uint8Array(512),Ye=new Uint8Array(256);(function(){let s=1;for(let o=0;o<255;o++)ze[o]=s,Ye[s]=o,s<<=1,s&256&&(s^=285);for(let o=255;o<512;o++)ze[o]=ze[o-255]})();Fe.log=function(s){if(s<1)throw new Error("log("+s+")");return Ye[s]};Fe.exp=function(s){return ze[s]};Fe.mul=function(s,o){return s===0||o===0?0:ze[Ye[s]+Ye[o]]};(function(n){const s=Fe;n.mul=function(r,i){const l=new Uint8Array(r.length+i.length-1);for(let c=0;c<r.length;c++)for(let g=0;g<i.length;g++)l[c+g]^=s.mul(r[c],i[g]);return l},n.mod=function(r,i){let l=new Uint8Array(r);for(;l.length-i.length>=0;){const c=l[0];for(let h=0;h<i.length;h++)l[h]^=s.mul(i[h],c);let g=0;for(;g<l.length&&l[g]===0;)g++;l=l.slice(g)}return l},n.generateECPolynomial=function(r){let i=new Uint8Array([1]);for(let l=0;l<r;l++)i=n.mul(i,new Uint8Array([1,s.exp(l)]));return i}})(sr);const nr=sr;function wt(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}wt.prototype.initialize=function(s){this.degree=s,this.genPoly=nr.generateECPolynomial(this.degree)};wt.prototype.encode=function(s){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(s.length+this.degree);o.set(s);const r=nr.mod(o,this.genPoly),i=this.degree-r.length;if(i>0){const l=new Uint8Array(this.degree);return l.set(r,i),l}return r};var Zr=wt,ar={},xe={},bt={};bt.isValid=function(s){return!isNaN(s)&&s>=1&&s<=40};var ie={};const ir="[0-9]+",Xr="[A-Z $%*+\\-./:]+";let Ve="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Ve=Ve.replace(/u/g,"\\u");const Fr="(?:(?![A-Z0-9 $%*+\\-./:]|"+Ve+`)(?:.|[\r
]))+`;ie.KANJI=new RegExp(Ve,"g");ie.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");ie.BYTE=new RegExp(Fr,"g");ie.NUMERIC=new RegExp(ir,"g");ie.ALPHANUMERIC=new RegExp(Xr,"g");const es=new RegExp("^"+Ve+"$"),ts=new RegExp("^"+ir+"$"),rs=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");ie.testKanji=function(s){return es.test(s)};ie.testNumeric=function(s){return ts.test(s)};ie.testAlphanumeric=function(s){return rs.test(s)};(function(n){const s=bt,o=ie;n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(l,c){if(!l.ccBits)throw new Error("Invalid mode: "+l);if(!s.isValid(c))throw new Error("Invalid version: "+c);return c>=1&&c<10?l.ccBits[0]:c<27?l.ccBits[1]:l.ccBits[2]},n.getBestModeForData=function(l){return o.testNumeric(l)?n.NUMERIC:o.testAlphanumeric(l)?n.ALPHANUMERIC:o.testKanji(l)?n.KANJI:n.BYTE},n.toString=function(l){if(l&&l.id)return l.id;throw new Error("Invalid mode")},n.isValid=function(l){return l&&l.bit&&l.ccBits};function r(i){if(typeof i!="string")throw new Error("Param is not a string");switch(i.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+i)}}n.from=function(l,c){if(n.isValid(l))return l;try{return r(l)}catch{return c}}})(xe);(function(n){const s=te,o=Xe,r=Ze,i=xe,l=bt,c=7973,g=s.getBCHDigit(c);function h(j,b,T){for(let p=1;p<=40;p++)if(b<=n.getCapacity(p,T,j))return p}function w(j,b){return i.getCharCountIndicator(j,b)+4}function f(j,b){let T=0;return j.forEach(function(p){const G=w(p.mode,b);T+=G+p.getBitsLength()}),T}function U(j,b){for(let T=1;T<=40;T++)if(f(j,T)<=n.getCapacity(T,b,i.MIXED))return T}n.from=function(b,T){return l.isValid(b)?parseInt(b,10):T},n.getCapacity=function(b,T,p){if(!l.isValid(b))throw new Error("Invalid QR Code version");typeof p>"u"&&(p=i.BYTE);const G=s.getSymbolTotalCodewords(b),_=o.getTotalCodewordsCount(b,T),R=(G-_)*8;if(p===i.MIXED)return R;const v=R-w(p,b);switch(p){case i.NUMERIC:return Math.floor(v/10*3);case i.ALPHANUMERIC:return Math.floor(v/11*2);case i.KANJI:return Math.floor(v/13);case i.BYTE:default:return Math.floor(v/8)}},n.getBestVersionForData=function(b,T){let p;const G=r.from(T,r.M);if(Array.isArray(b)){if(b.length>1)return U(b,G);if(b.length===0)return 1;p=b[0]}else p=b;return h(p.mode,p.getLength(),G)},n.getEncodedBits=function(b){if(!l.isValid(b)||b<7)throw new Error("Invalid QR Code version");let T=b<<12;for(;s.getBCHDigit(T)-g>=0;)T^=c<<s.getBCHDigit(T)-g;return b<<12|T}})(ar);var lr={};const mt=te,or=1335,ss=21522,Yt=mt.getBCHDigit(or);lr.getEncodedBits=function(s,o){const r=s.bit<<3|o;let i=r<<10;for(;mt.getBCHDigit(i)-Yt>=0;)i^=or<<mt.getBCHDigit(i)-Yt;return(r<<10|i)^ss};var dr={};const ns=xe;function ve(n){this.mode=ns.NUMERIC,this.data=n.toString()}ve.getBitsLength=function(s){return 10*Math.floor(s/3)+(s%3?s%3*3+1:0)};ve.prototype.getLength=function(){return this.data.length};ve.prototype.getBitsLength=function(){return ve.getBitsLength(this.data.length)};ve.prototype.write=function(s){let o,r,i;for(o=0;o+3<=this.data.length;o+=3)r=this.data.substr(o,3),i=parseInt(r,10),s.put(i,10);const l=this.data.length-o;l>0&&(r=this.data.substr(o),i=parseInt(r,10),s.put(i,l*3+1))};var as=ve;const is=xe,dt=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function _e(n){this.mode=is.ALPHANUMERIC,this.data=n}_e.getBitsLength=function(s){return 11*Math.floor(s/2)+6*(s%2)};_e.prototype.getLength=function(){return this.data.length};_e.prototype.getBitsLength=function(){return _e.getBitsLength(this.data.length)};_e.prototype.write=function(s){let o;for(o=0;o+2<=this.data.length;o+=2){let r=dt.indexOf(this.data[o])*45;r+=dt.indexOf(this.data[o+1]),s.put(r,11)}this.data.length%2&&s.put(dt.indexOf(this.data[o]),6)};var ls=_e;const os=xe;function Se(n){this.mode=os.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}Se.getBitsLength=function(s){return s*8};Se.prototype.getLength=function(){return this.data.length};Se.prototype.getBitsLength=function(){return Se.getBitsLength(this.data.length)};Se.prototype.write=function(n){for(let s=0,o=this.data.length;s<o;s++)n.put(this.data[s],8)};var ds=Se;const cs=xe,hs=te;function Ee(n){this.mode=cs.KANJI,this.data=n}Ee.getBitsLength=function(s){return s*13};Ee.prototype.getLength=function(){return this.data.length};Ee.prototype.getBitsLength=function(){return Ee.getBitsLength(this.data.length)};Ee.prototype.write=function(n){let s;for(s=0;s<this.data.length;s++){let o=hs.toSJIS(this.data[s]);if(o>=33088&&o<=40956)o-=33088;else if(o>=57408&&o<=60351)o-=49472;else throw new Error("Invalid SJIS character: "+this.data[s]+`
Make sure your charset is UTF-8`);o=(o>>>8&255)*192+(o&255),n.put(o,13)}};var gs=Ee,cr={exports:{}};(function(n){var s={single_source_shortest_paths:function(o,r,i){var l={},c={};c[r]=0;var g=s.PriorityQueue.make();g.push(r,0);for(var h,w,f,U,j,b,T,p,G;!g.empty();){h=g.pop(),w=h.value,U=h.cost,j=o[w]||{};for(f in j)j.hasOwnProperty(f)&&(b=j[f],T=U+b,p=c[f],G=typeof c[f]>"u",(G||p>T)&&(c[f]=T,g.push(f,T),l[f]=w))}if(typeof i<"u"&&typeof c[i]>"u"){var _=["Could not find a path from ",r," to ",i,"."].join("");throw new Error(_)}return l},extract_shortest_path_from_predecessor_list:function(o,r){for(var i=[],l=r;l;)i.push(l),o[l],l=o[l];return i.reverse(),i},find_path:function(o,r,i){var l=s.single_source_shortest_paths(o,r,i);return s.extract_shortest_path_from_predecessor_list(l,i)},PriorityQueue:{make:function(o){var r=s.PriorityQueue,i={},l;o=o||{};for(l in r)r.hasOwnProperty(l)&&(i[l]=r[l]);return i.queue=[],i.sorter=o.sorter||r.default_sorter,i},default_sorter:function(o,r){return o.cost-r.cost},push:function(o,r){var i={value:o,cost:r};this.queue.push(i),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=s})(cr);var us=cr.exports;(function(n){const s=xe,o=as,r=ls,i=ds,l=gs,c=ie,g=te,h=us;function w(_){return unescape(encodeURIComponent(_)).length}function f(_,R,v){const S=[];let I;for(;(I=_.exec(v))!==null;)S.push({data:I[0],index:I.index,mode:R,length:I[0].length});return S}function U(_){const R=f(c.NUMERIC,s.NUMERIC,_),v=f(c.ALPHANUMERIC,s.ALPHANUMERIC,_);let S,I;return g.isKanjiModeEnabled()?(S=f(c.BYTE,s.BYTE,_),I=f(c.KANJI,s.KANJI,_)):(S=f(c.BYTE_KANJI,s.BYTE,_),I=[]),R.concat(v,S,I).sort(function(M,E){return M.index-E.index}).map(function(M){return{data:M.data,mode:M.mode,length:M.length}})}function j(_,R){switch(R){case s.NUMERIC:return o.getBitsLength(_);case s.ALPHANUMERIC:return r.getBitsLength(_);case s.KANJI:return l.getBitsLength(_);case s.BYTE:return i.getBitsLength(_)}}function b(_){return _.reduce(function(R,v){const S=R.length-1>=0?R[R.length-1]:null;return S&&S.mode===v.mode?(R[R.length-1].data+=v.data,R):(R.push(v),R)},[])}function T(_){const R=[];for(let v=0;v<_.length;v++){const S=_[v];switch(S.mode){case s.NUMERIC:R.push([S,{data:S.data,mode:s.ALPHANUMERIC,length:S.length},{data:S.data,mode:s.BYTE,length:S.length}]);break;case s.ALPHANUMERIC:R.push([S,{data:S.data,mode:s.BYTE,length:S.length}]);break;case s.KANJI:R.push([S,{data:S.data,mode:s.BYTE,length:w(S.data)}]);break;case s.BYTE:R.push([{data:S.data,mode:s.BYTE,length:w(S.data)}])}}return R}function p(_,R){const v={},S={start:{}};let I=["start"];for(let x=0;x<_.length;x++){const M=_[x],E=[];for(let B=0;B<M.length;B++){const $=M[B],ce=""+x+B;E.push(ce),v[ce]={node:$,lastCount:0},S[ce]={};for(let K=0;K<I.length;K++){const re=I[K];v[re]&&v[re].node.mode===$.mode?(S[re][ce]=j(v[re].lastCount+$.length,$.mode)-j(v[re].lastCount,$.mode),v[re].lastCount+=$.length):(v[re]&&(v[re].lastCount=$.length),S[re][ce]=j($.length,$.mode)+4+s.getCharCountIndicator($.mode,R))}}I=E}for(let x=0;x<I.length;x++)S[I[x]].end=0;return{map:S,table:v}}function G(_,R){let v;const S=s.getBestModeForData(_);if(v=s.from(R,S),v!==s.BYTE&&v.bit<S.bit)throw new Error('"'+_+'" cannot be encoded with mode '+s.toString(v)+`.
 Suggested mode is: `+s.toString(S));switch(v===s.KANJI&&!g.isKanjiModeEnabled()&&(v=s.BYTE),v){case s.NUMERIC:return new o(_);case s.ALPHANUMERIC:return new r(_);case s.KANJI:return new l(_);case s.BYTE:return new i(_)}}n.fromArray=function(R){return R.reduce(function(v,S){return typeof S=="string"?v.push(G(S,null)):S.data&&v.push(G(S.data,S.mode)),v},[])},n.fromString=function(R,v){const S=U(R,g.isKanjiModeEnabled()),I=T(S),x=p(I,v),M=h.find_path(x.map,"start","end"),E=[];for(let B=1;B<M.length-1;B++)E.push(x.table[M[B]].node);return n.fromArray(b(E))},n.rawSplit=function(R){return n.fromArray(U(R,g.isKanjiModeEnabled()))}})(dr);const et=te,ct=Ze,ms=Jr,xs=Yr,fs=er,ps=tr,xt=rr,ft=Xe,ys=Zr,We=ar,ws=lr,bs=xe,ht=dr;function Ns(n,s){const o=n.size,r=ps.getPositions(s);for(let i=0;i<r.length;i++){const l=r[i][0],c=r[i][1];for(let g=-1;g<=7;g++)if(!(l+g<=-1||o<=l+g))for(let h=-1;h<=7;h++)c+h<=-1||o<=c+h||(g>=0&&g<=6&&(h===0||h===6)||h>=0&&h<=6&&(g===0||g===6)||g>=2&&g<=4&&h>=2&&h<=4?n.set(l+g,c+h,!0,!0):n.set(l+g,c+h,!1,!0))}}function js(n){const s=n.size;for(let o=8;o<s-8;o++){const r=o%2===0;n.set(o,6,r,!0),n.set(6,o,r,!0)}}function Cs(n,s){const o=fs.getPositions(s);for(let r=0;r<o.length;r++){const i=o[r][0],l=o[r][1];for(let c=-2;c<=2;c++)for(let g=-2;g<=2;g++)c===-2||c===2||g===-2||g===2||c===0&&g===0?n.set(i+c,l+g,!0,!0):n.set(i+c,l+g,!1,!0)}}function vs(n,s){const o=n.size,r=We.getEncodedBits(s);let i,l,c;for(let g=0;g<18;g++)i=Math.floor(g/3),l=g%3+o-8-3,c=(r>>g&1)===1,n.set(i,l,c,!0),n.set(l,i,c,!0)}function gt(n,s,o){const r=n.size,i=ws.getEncodedBits(s,o);let l,c;for(l=0;l<15;l++)c=(i>>l&1)===1,l<6?n.set(l,8,c,!0):l<8?n.set(l+1,8,c,!0):n.set(r-15+l,8,c,!0),l<8?n.set(8,r-l-1,c,!0):l<9?n.set(8,15-l-1+1,c,!0):n.set(8,15-l-1,c,!0);n.set(r-8,8,1,!0)}function _s(n,s){const o=n.size;let r=-1,i=o-1,l=7,c=0;for(let g=o-1;g>0;g-=2)for(g===6&&g--;;){for(let h=0;h<2;h++)if(!n.isReserved(i,g-h)){let w=!1;c<s.length&&(w=(s[c]>>>l&1)===1),n.set(i,g-h,w),l--,l===-1&&(c++,l=7)}if(i+=r,i<0||o<=i){i-=r,r=-r;break}}}function Ss(n,s,o){const r=new ms;o.forEach(function(h){r.put(h.mode.bit,4),r.put(h.getLength(),bs.getCharCountIndicator(h.mode,n)),h.write(r)});const i=et.getSymbolTotalCodewords(n),l=ft.getTotalCodewordsCount(n,s),c=(i-l)*8;for(r.getLengthInBits()+4<=c&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const g=(c-r.getLengthInBits())/8;for(let h=0;h<g;h++)r.put(h%2?17:236,8);return Es(r,n,s)}function Es(n,s,o){const r=et.getSymbolTotalCodewords(s),i=ft.getTotalCodewordsCount(s,o),l=r-i,c=ft.getBlocksCount(s,o),g=r%c,h=c-g,w=Math.floor(r/c),f=Math.floor(l/c),U=f+1,j=w-f,b=new ys(j);let T=0;const p=new Array(c),G=new Array(c);let _=0;const R=new Uint8Array(n.buffer);for(let M=0;M<c;M++){const E=M<h?f:U;p[M]=R.slice(T,T+E),G[M]=b.encode(p[M]),T+=E,_=Math.max(_,E)}const v=new Uint8Array(r);let S=0,I,x;for(I=0;I<_;I++)for(x=0;x<c;x++)I<p[x].length&&(v[S++]=p[x][I]);for(I=0;I<j;I++)for(x=0;x<c;x++)v[S++]=G[x][I];return v}function As(n,s,o,r){let i;if(Array.isArray(n))i=ht.fromArray(n);else if(typeof n=="string"){let w=s;if(!w){const f=ht.rawSplit(n);w=We.getBestVersionForData(f,o)}i=ht.fromString(n,w||40)}else throw new Error("Invalid data");const l=We.getBestVersionForData(i,o);if(!l)throw new Error("The amount of data is too big to be stored in a QR Code");if(!s)s=l;else if(s<l)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+l+`.
`);const c=Ss(s,o,i),g=et.getSymbolSize(s),h=new xs(g);return Ns(h,s),js(h),Cs(h,s),gt(h,o,0),s>=7&&vs(h,s),_s(h,c),isNaN(r)&&(r=xt.getBestMask(h,gt.bind(null,h,o))),xt.applyMask(r,h),gt(h,o,r),{modules:h,version:s,errorCorrectionLevel:o,maskPattern:r,segments:i}}Xt.create=function(s,o){if(typeof s>"u"||s==="")throw new Error("No input text");let r=ct.M,i,l;return typeof o<"u"&&(r=ct.from(o.errorCorrectionLevel,ct.M),i=We.from(o.version),l=xt.from(o.maskPattern),o.toSJISFunc&&et.setToSJISFunction(o.toSJISFunc)),As(s,i,r,l)};var hr={},Nt={};(function(n){function s(o){if(typeof o=="number"&&(o=o.toString()),typeof o!="string")throw new Error("Color should be defined as hex string");let r=o.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+o);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(l){return[l,l]}))),r.length===6&&r.push("F","F");const i=parseInt(r.join(""),16);return{r:i>>24&255,g:i>>16&255,b:i>>8&255,a:i&255,hex:"#"+r.slice(0,6).join("")}}n.getOptions=function(r){r||(r={}),r.color||(r.color={});const i=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,l=r.width&&r.width>=21?r.width:void 0,c=r.scale||4;return{width:l,scale:l?4:c,margin:i,color:{dark:s(r.color.dark||"#000000ff"),light:s(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},n.getScale=function(r,i){return i.width&&i.width>=r+i.margin*2?i.width/(r+i.margin*2):i.scale},n.getImageWidth=function(r,i){const l=n.getScale(r,i);return Math.floor((r+i.margin*2)*l)},n.qrToImageData=function(r,i,l){const c=i.modules.size,g=i.modules.data,h=n.getScale(c,l),w=Math.floor((c+l.margin*2)*h),f=l.margin*h,U=[l.color.light,l.color.dark];for(let j=0;j<w;j++)for(let b=0;b<w;b++){let T=(j*w+b)*4,p=l.color.light;if(j>=f&&b>=f&&j<w-f&&b<w-f){const G=Math.floor((j-f)/h),_=Math.floor((b-f)/h);p=U[g[G*c+_]?1:0]}r[T++]=p.r,r[T++]=p.g,r[T++]=p.b,r[T]=p.a}}})(Nt);(function(n){const s=Nt;function o(i,l,c){i.clearRect(0,0,l.width,l.height),l.style||(l.style={}),l.height=c,l.width=c,l.style.height=c+"px",l.style.width=c+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(l,c,g){let h=g,w=c;typeof h>"u"&&(!c||!c.getContext)&&(h=c,c=void 0),c||(w=r()),h=s.getOptions(h);const f=s.getImageWidth(l.modules.size,h),U=w.getContext("2d"),j=U.createImageData(f,f);return s.qrToImageData(j.data,l,h),o(U,w,f),U.putImageData(j,0,0),w},n.renderToDataURL=function(l,c,g){let h=g;typeof h>"u"&&(!c||!c.getContext)&&(h=c,c=void 0),h||(h={});const w=n.render(l,c,h),f=h.type||"image/png",U=h.rendererOpts||{};return w.toDataURL(f,U.quality)}})(hr);var gr={};const ks=Nt;function Wt(n,s){const o=n.a/255,r=s+'="'+n.hex+'"';return o<1?r+" "+s+'-opacity="'+o.toFixed(2).slice(1)+'"':r}function ut(n,s,o){let r=n+s;return typeof o<"u"&&(r+=" "+o),r}function Ts(n,s,o){let r="",i=0,l=!1,c=0;for(let g=0;g<n.length;g++){const h=Math.floor(g%s),w=Math.floor(g/s);!h&&!l&&(l=!0),n[g]?(c++,g>0&&h>0&&n[g-1]||(r+=l?ut("M",h+o,.5+w+o):ut("m",i,0),i=0,l=!1),h+1<s&&n[g+1]||(r+=ut("h",c),c=0)):i++}return r}gr.render=function(s,o,r){const i=ks.getOptions(o),l=s.modules.size,c=s.modules.data,g=l+i.margin*2,h=i.color.light.a?"<path "+Wt(i.color.light,"fill")+' d="M0 0h'+g+"v"+g+'H0z"/>':"",w="<path "+Wt(i.color.dark,"stroke")+' d="'+Ts(c,l,i.margin)+'"/>',f='viewBox="0 0 '+g+" "+g+'"',j='<svg xmlns="http://www.w3.org/2000/svg" '+(i.width?'width="'+i.width+'" height="'+i.width+'" ':"")+f+' shape-rendering="crispEdges">'+h+w+`</svg>
`;return typeof r=="function"&&r(null,j),j};const Rs=Hr,pt=Xt,ur=hr,Ms=gr;function jt(n,s,o,r,i){const l=[].slice.call(arguments,1),c=l.length,g=typeof l[c-1]=="function";if(!g&&!Rs())throw new Error("Callback required as last argument");if(g){if(c<2)throw new Error("Too few arguments provided");c===2?(i=o,o=s,s=r=void 0):c===3&&(s.getContext&&typeof i>"u"?(i=r,r=void 0):(i=r,r=o,o=s,s=void 0))}else{if(c<1)throw new Error("Too few arguments provided");return c===1?(o=s,s=r=void 0):c===2&&!s.getContext&&(r=o,o=s,s=void 0),new Promise(function(h,w){try{const f=pt.create(o,r);h(n(f,s,r))}catch(f){w(f)}})}try{const h=pt.create(o,r);i(null,n(h,s,r))}catch(h){i(h)}}ye.create=pt.create;ye.toCanvas=jt.bind(null,ur.render);ye.toDataURL=jt.bind(null,ur.renderToDataURL);ye.toString=jt.bind(null,function(n,s,o){return Ms.render(n,o)});const Ps=({url:n,title:s="QR Code",description:o="Scan this QR code to access the form",size:r=200,showControls:i=!0})=>{const[l,c]=L.useState(null),[g,h]=L.useState(!1),[w,f]=L.useState(null),[U,j]=L.useState(!1),[b,T]=L.useState(r),[p,G]=L.useState(n||"");L.useRef(null),L.useEffect(()=>{p!=null&&p.trim()&&_(p,b)},[p,b]);const _=async(x,M=200)=>{var E;try{if(h(!0),f(null),!(x!=null&&x.trim()))throw new Error("URL is required to generate QR code");let B=x==null?void 0:x.trim();!(B!=null&&B.startsWith("http://"))&&!(B!=null&&B.startsWith("https://"))&&(B!=null&&B.startsWith("/")?B=`${(E=window==null?void 0:window.location)==null?void 0:E.origin}${B}`:B=`https://${B}`);const $=await(ye==null?void 0:ye.toDataURL(B,{width:M,height:M,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"}));c($)}catch(B){console.error("Error generating QR code:",B),f((B==null?void 0:B.message)||"Failed to generate QR code")}finally{h(!1)}},R=()=>{var x,M;if(l)try{const E=document==null?void 0:document.createElement("a");E.download=`${s==null?void 0:s.replace(/[^a-zA-Z0-9]/g,"_")}_QRCode.png`,E.href=l,(x=document==null?void 0:document.body)==null||x.appendChild(E),E==null||E.click(),(M=document==null?void 0:document.body)==null||M.removeChild(E)}catch(E){console.error("Error downloading QR code:",E),f("Failed to download QR code")}},v=async()=>{var x,M,E;try{if(navigator!=null&&navigator.clipboard&&l){const B=await fetch(l),$=await(B==null?void 0:B.blob());await((x=navigator==null?void 0:navigator.clipboard)==null?void 0:x.write([new ClipboardItem({"image/png":$})])),j(!0),setTimeout(()=>j(!1),2e3)}else await((M=navigator==null?void 0:navigator.clipboard)==null?void 0:M.writeText(p)),j(!0),setTimeout(()=>j(!1),2e3)}catch(B){console.error("Error copying to clipboard:",B);try{await((E=navigator==null?void 0:navigator.clipboard)==null?void 0:E.writeText(p)),j(!0),setTimeout(()=>j(!1),2e3)}catch{f("Failed to copy to clipboard")}}},S=async()=>{try{if(navigator!=null&&navigator.share&&l){const x=await fetch(l),M=await(x==null?void 0:x.blob()),E=new File([M],`${s}_QRCode.png`,{type:"image/png"});await(navigator==null?void 0:navigator.share({title:s,text:o,url:p,files:[E]}))}else await v()}catch(x){console.error("Error sharing QR code:",x),(x==null?void 0:x.name)!=="AbortError"&&f("Failed to share QR code")}},I=()=>{G(n||""),T(r),f(null),j(!1)};return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Je,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s})]}),o&&e.jsx("p",{className:"text-gray-600 text-sm mb-6",children:o}),w&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Zt,{className:"w-4 h-4 text-red-600 mr-2"}),e.jsx("p",{className:"text-red-800 text-sm",children:w})]})}),i&&e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL to Generate QR Code"}),e.jsx("input",{type:"url",value:p,onChange:x=>{var M;return G((M=x==null?void 0:x.target)==null?void 0:M.value)},placeholder:"Enter URL (e.g., https://yoursite.com/guest-claims-form)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["QR Code Size: ",b,"px"]}),e.jsx("input",{type:"range",min:"100",max:"400",step:"25",value:b,onChange:x=>{var M;return T(parseInt((M=x==null?void 0:x.target)==null?void 0:M.value))},className:"w-full"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{onClick:()=>_(p,b),disabled:g||!(p!=null&&p.trim()),variant:"primary",size:"md",className:"","aria-label":"Generate QR Code",children:g?"Generating...":"Generate QR Code"}),e.jsx(Y,{onClick:I,variant:"secondary",size:"md",className:"","aria-label":"Reset to default values",children:"Reset"})]})]}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[g&&e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Generating QR Code..."})]}),l&&!g&&e.jsx("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 shadow-sm",children:e.jsx("img",{src:l,alt:`QR Code for ${s}`,className:"block",style:{width:b,height:b}})}),!l&&!g&&(p==null?void 0:p.trim())&&e.jsx("div",{className:"flex items-center justify-center p-8 border-2 border-dashed border-gray-300 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Je,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:'Click "Generate QR Code" to create QR code'})]})}),!(p!=null&&p.trim())&&i&&e.jsx("div",{className:"flex items-center justify-center p-8 border-2 border-dashed border-gray-300 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Je,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Enter a URL to generate QR code"})]})})]}),l&&e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsxs(Y,{onClick:R,variant:"primary",size:"md",className:"","aria-label":"Download QR Code as PNG",children:[e.jsx(Br,{className:"w-4 h-4 mr-1"}),"Download PNG"]}),e.jsxs(Y,{onClick:v,variant:"secondary",size:"md",className:"","aria-label":U?"QR Code copied":"Copy QR Code to clipboard",children:[U?e.jsx(Dr,{className:"w-4 h-4 mr-1"}):e.jsx(Lr,{className:"w-4 h-4 mr-1"}),U?"Copied!":"Copy"]}),(navigator==null?void 0:navigator.share)&&e.jsxs(Y,{onClick:S,variant:"secondary",size:"md",className:"","aria-label":"Share QR Code",children:[e.jsx(Ir,{className:"w-4 h-4 mr-1"}),"Share"]})]}),p&&e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Target URL:"}),e.jsx("p",{className:"text-sm font-mono text-gray-800 break-all",children:p})]})]})},Vs=()=>{var At,kt,Tt,Rt,Mt;const{userProfile:n,user:s,loading:o}=Ur(),{orgId:r}=Qr(),{logBusinessAction:i,logError:l}=Gr(),[c,g]=L.useState(!0),[h,w]=L.useState("userAccounts"),[f,U]=L.useState(null),[j,b]=L.useState(!0),[T,p]=L.useState(""),[G,_]=L.useState(""),[R,v]=L.useState(""),[S,I]=L.useState(""),[x,M]=L.useState({authUser:null,userProfile:null,profileLoadError:null,showDebug:!1}),[E,B]=L.useState([]),[$,ce]=L.useState([]),[K,re]=L.useState([]),[X,Ct]=L.useState([]),[W,vt]=L.useState([]),[le,ee]=L.useState(!1),[Ae,_t]=L.useState(null),[mr,Qe]=L.useState(!1),[ne,xr]=L.useState(""),[A,St]=L.useState(null),[N,fe]=L.useState({full_name:"",email:"",password:"",role:"manager",department:"",phone:""}),[q,ke]=L.useState({full_name:"",phone:"",email:"",department:""}),[k,pe]=L.useState({name:"",contact_person:"",phone:"",email:"",specialty:"",rating:""}),[y,oe]=L.useState({name:"",brand:"",category:"",cost:"",unit_price:"",part_number:"",description:"",op_code:""}),[O,Ge]=L.useState({name:"",message_template:"",template_type:"job_status"}),tt=[{id:"userAccounts",label:"User Accounts",icon:qr},{id:"staffRecords",label:"Staff Records",icon:zr},{id:"vendors",label:"Vendors",icon:ue},{id:"products",label:"Aftermarket Products",icon:Vr},{id:"smsTemplates",label:"SMS Templates",icon:Or},{id:"qrCodes",label:"QR Code Generator",icon:Je}],rt=[{value:"admin",label:"Admin"},{value:"manager",label:"Manager"},{value:"staff",label:"Staff"},{value:"vendor",label:"Vendor"}],st=[{value:"Delivery Coordinator",label:"Delivery Coordinator"},{value:"Managers",label:"Managers"}],nt=[{value:"Sales Consultants",label:"Sales Consultants"},{value:"Finance Manager",label:"Finance Manager"}],at=[{value:"job_status",label:"Job Status"},{value:"overdue_alert",label:"Overdue Alert"},{value:"customer_notification",label:"Customer Notification"},{value:"vendor_assignment",label:"Vendor Assignment"},{value:"completion_notice",label:"Completion Notice"}];L.useEffect(()=>{o||(async()=>{var u,a,d;try{if(console.log("Admin panel initializing...",{authLoading:o,user:!!s,userProfile:!!n}),!P){U("Database connection unavailable. Please refresh the page."),g(!1);return}const{error:m}=await((d=(a=(u=P)==null?void 0:u.from("user_profiles"))==null?void 0:a.select("id"))==null?void 0:d.limit(1));if(m){console.error("Database connection failed:",m),U("Unable to connect to database. Please check your Supabase configuration."),g(!1);return}await Et(),g(!1)}catch(m){console.error("Admin initialization failed:",m),U("Failed to initialize admin panel: "+(m==null?void 0:m.message)),g(!1)}})()},[o]);const fr=async()=>{var t,u,a,d,m,D,V,Z,se,F,de,he,Pe,Be,De;console.log("=== ADMIN ACCESS DEBUG ===");try{const{data:{session:z},error:Ne}=await((u=(t=P)==null?void 0:t.auth)==null?void 0:u.getSession());if(console.log("Current session:",{hasSession:!!z,sessionError:Ne,userId:(a=z==null?void 0:z.user)==null?void 0:a.id,userEmail:(d=z==null?void 0:z.user)==null?void 0:d.email}),z!=null&&z.user){console.log("Auth user:",{id:(m=z==null?void 0:z.user)==null?void 0:m.id,email:(D=z==null?void 0:z.user)==null?void 0:D.email,role:(V=z==null?void 0:z.user)==null?void 0:V.role}),console.log("Attempting to fetch user profile...");const{data:Ce,error:Ie}=await((he=(de=(se=(Z=P)==null?void 0:Z.from("user_profiles"))==null?void 0:se.select("*"))==null?void 0:de.eq("id",(F=z==null?void 0:z.user)==null?void 0:F.id))==null?void 0:he.single());console.log("Direct profile fetch result:",{profile:Ce,profileError:Ie,hasProfile:!!Ce}),M({authUser:z==null?void 0:z.user,userProfile:Ce,profileLoadError:Ie,showDebug:!0})}else console.log("No authenticated user found"),M({authUser:null,userProfile:null,profileLoadError:{message:"No authenticated user"},showDebug:!0});console.log("Testing database access...");const{data:je,error:Le}=await((De=(Be=(Pe=P)==null?void 0:Pe.from("user_profiles"))==null?void 0:Be.select("id, full_name, role"))==null?void 0:De.limit(5));console.log("Database access test:",{canAccess:!Le,recordCount:(je==null?void 0:je.length)||0,error:Le})}catch(z){console.error("Debug error:",z),M(Ne=>({...Ne,profileLoadError:z,showDebug:!0}))}},Et=async()=>{console.log("Loading admin data...");try{const t=await Promise.allSettled([we(),be(),Te(),Re(),lt()]);t==null||t.forEach((u,a)=>{const d=["User Accounts","Staff Records","Vendors","Products","SMS Templates"];(u==null?void 0:u.status)==="rejected"?console.error(`Failed to load ${d==null?void 0:d[a]}:`,u==null?void 0:u.reason):console.log(`Successfully loaded ${d==null?void 0:d[a]}`)})}catch(t){console.error("Error loading admin data:",t),U("Failed to load some admin data. Please try refreshing the page.")}},we=async()=>{var t,u,a;try{console.log("Loading user accounts...");let d=(a=(u=(t=P)==null?void 0:t.from("user_profiles"))==null?void 0:u.select("*",{count:"exact"}))==null?void 0:a.in("role",["admin","manager"]);j&&r&&(d=d==null?void 0:d.eq("org_id",r)),d=d==null?void 0:d.order("created_at",{ascending:!1});const{data:m,error:D,count:V}=await d;if(D)throw console.error("User accounts query error:",D),D;console.log(`User accounts query result: ${(m==null?void 0:m.length)||0} records`),B(m||[])}catch(d){console.error("Error loading user accounts:",d)}},be=async()=>{var t,u,a;try{console.log("Loading staff records...");let d=(a=(u=(t=P)==null?void 0:t.from("user_profiles"))==null?void 0:u.select("*",{count:"exact"}))==null?void 0:a.eq("role","staff");j&&r&&(d=d==null?void 0:d.eq("org_id",r)),d=d==null?void 0:d.order("created_at",{ascending:!1});const{data:m,error:D}=await d;if(D)throw console.error("Staff records query error:",D),D;console.log(`Staff records: ${m==null?void 0:m.length} staff members found`),ce(m||[])}catch(d){console.error("Error loading staff records:",d)}},it=async t=>{var u,a,d;if(!r){alert("No organization detected for current user");return}try{ee(!0);const{error:m}=await((d=(a=(u=P)==null?void 0:u.from("user_profiles"))==null?void 0:a.update({org_id:r,is_active:!0}))==null?void 0:d.eq("id",t));if(m)throw m;await Promise.all([we(),be()]);try{await(i==null?void 0:i("attach_profile_to_org","admin",t,"Attached user profile to current org",{orgId:r}))}catch{}}catch(m){console.error("attachProfileToMyOrg error:",m),alert("Failed to attach to org: "+((m==null?void 0:m.message)||"Unknown error"));try{await(l==null?void 0:l(m,{where:"attachProfileToMyOrg",orgId:r,profileId:t}))}catch{}}finally{ee(!1)}},pr=async()=>{var t,u,a,d;if(p(""),!r){p("No organization detected for current user.");return}try{ee(!0);const{error:m}=await((d=(a=(u=(t=P)==null?void 0:t.from("user_profiles"))==null?void 0:u.update({org_id:r,is_active:!0}))==null?void 0:a.is("org_id",null))==null?void 0:d.eq("role","staff"));if(m)throw m;p("Assigned org to active staff without org."),await be();try{await(i==null?void 0:i("assign_org_staff","system",null,"Assigned org to staff without org",{orgId:r}))}catch{}}catch(m){console.error("assignOrgToActiveStaff error:",m),p((m==null?void 0:m.message)||"Failed to assign org to staff");try{await(l==null?void 0:l(m,{where:"assignOrgToActiveStaff",orgId:r}))}catch{}}finally{ee(!1)}},yr=async()=>{var t,u,a,d;if(_(""),!r){_("No organization detected for current user.");return}try{ee(!0);const{error:m}=await((d=(a=(u=(t=P)==null?void 0:t.from("user_profiles"))==null?void 0:u.update({org_id:r,is_active:!0}))==null?void 0:a.is("org_id",null))==null?void 0:d.in("role",["admin","manager"]));if(m)throw m;_("Assigned org to admin/manager accounts without org."),await we()}catch(m){console.error("assignOrgToAccounts error:",m),_((m==null?void 0:m.message)||"Failed to assign org to accounts")}finally{ee(!1)}};L.useEffect(()=>{be(),we(),Te(),Re()},[j,r]);const Te=async()=>{var t,u;try{console.log("Loading vendors...");let a=(u=(t=P)==null?void 0:t.from("vendors"))==null?void 0:u.select("*",{count:"exact"});j&&r&&(a=a==null?void 0:a.eq("org_id",r)),a=a==null?void 0:a.order("created_at",{ascending:!1});const{data:d,error:m,count:D}=await a;if(m)throw console.error("Vendors query error:",m),m;console.log(`Vendors query result: ${(d==null?void 0:d.length)||0} records`),re(d||[])}catch(a){console.error("Error loading vendors:",a)}},Re=async()=>{var t,u;try{console.log("Loading products...");let a=(u=(t=P)==null?void 0:t.from("products"))==null?void 0:u.select("*, vendors(name)",{count:"exact"});j&&r&&(a=a==null?void 0:a.eq("org_id",r)),a=a==null?void 0:a.order("created_at",{ascending:!1});const{data:d,error:m,count:D}=await a;if(m)throw console.error("Products query error:",m),m;console.log(`Products query result: ${(d==null?void 0:d.length)||0} records`),Ct(d||[])}catch(a){console.error("Error loading products:",a)}},wr=async()=>{var t,u,a;if(v(""),!r){v("No organization detected for current user.");return}try{ee(!0);const{error:d}=await((a=(u=(t=P)==null?void 0:t.from("vendors"))==null?void 0:u.update({org_id:r}))==null?void 0:a.is("org_id",null));if(d)throw d;v("Assigned org to vendors without org."),await Te();try{await(i==null?void 0:i("assign_org_vendors","system",null,"Assigned org to vendors without org",{orgId:r}))}catch{}}catch(d){console.error("assignOrgToVendors error:",d),v((d==null?void 0:d.message)||"Failed to assign org to vendors");try{await(l==null?void 0:l(d,{where:"assignOrgToVendors",orgId:r}))}catch{}}finally{ee(!1)}},br=async()=>{var t,u,a;if(I(""),!r){I("No organization detected for current user.");return}try{ee(!0);const{error:d}=await((a=(u=(t=P)==null?void 0:t.from("products"))==null?void 0:u.update({org_id:r}))==null?void 0:a.is("org_id",null));if(d)throw d;I("Assigned org to products without org."),await Re();try{await(i==null?void 0:i("assign_org_products","system",null,"Assigned org to products without org",{orgId:r}))}catch{}}catch(d){console.error("assignOrgToProducts error:",d),I((d==null?void 0:d.message)||"Failed to assign org to products");try{await(l==null?void 0:l(d,{where:"assignOrgToProducts",orgId:r}))}catch{}}finally{ee(!1)}},lt=async()=>{var t,u,a;try{console.log("Loading SMS templates...");const{data:d,error:m,count:D}=await((a=(u=(t=P)==null?void 0:t.from("sms_templates"))==null?void 0:u.select("*",{count:"exact"}))==null?void 0:a.order("created_at",{ascending:!1}));if(m)throw console.error("SMS templates query error:",m),m;console.log(`SMS templates query result: ${(d==null?void 0:d.length)||0} records`),vt(d||[])}catch(d){console.error("Error loading SMS templates:",d)}},ae=(t,u=null)=>{xr(t),St(u),Qe(!0),t==="userAccount"?fe(u||{full_name:"",email:"",password:"",role:"manager",department:"",phone:""}):t==="staff"?ke(u||{full_name:"",phone:"",email:"",department:""}):t==="vendor"?pe(u||{name:"",contact_person:"",phone:"",email:"",specialty:"",rating:""}):t==="product"?oe(u||{name:"",brand:"",category:"",cost:"",unit_price:"",part_number:"",description:"",op_code:""}):t==="template"&&Ge(u||{name:"",message_template:"",template_type:"job_status"})},Nr=async t=>{t==null||t.preventDefault(),ee(!0);try{ne==="userAccount"?await jr():ne==="staff"?await Cr():ne==="vendor"?await vr():ne==="product"?await _r():ne==="template"&&await Sr(),Qe(!1),St(null)}catch(u){console.error("Error submitting form:",u),alert("Error: "+(u==null?void 0:u.message))}finally{ee(!1)}},jr=async()=>{var t,u,a,d,m,D,V,Z;if(A){if(r&&(A!=null&&A.org_id)&&(A==null?void 0:A.org_id)!==r){if(!window.confirm("This user belongs to another organization. Reassign to your org and continue editing?"))throw new Error("Edit cancelled. User belongs to another organization.");const{error:de}=await((a=(u=(t=P)==null?void 0:t.from("user_profiles"))==null?void 0:u.update({org_id:r,is_active:!0}))==null?void 0:a.eq("id",A==null?void 0:A.id));if(de)throw de}const{error:se}=await((D=(m=(d=P)==null?void 0:d.from("user_profiles"))==null?void 0:m.update({full_name:N==null?void 0:N.full_name,email:N==null?void 0:N.email,role:N==null?void 0:N.role,department:N==null?void 0:N.department,phone:N==null?void 0:N.phone}))==null?void 0:D.eq("id",A==null?void 0:A.id));if(se)throw se}else{if(!(N!=null&&N.password))throw new Error("Password is required for new users");const{data:se,error:F}=await((Z=(V=P)==null?void 0:V.auth)==null?void 0:Z.signUp({email:N==null?void 0:N.email,password:N==null?void 0:N.password,options:{data:{full_name:N==null?void 0:N.full_name,role:N==null?void 0:N.role,department:N==null?void 0:N.department,phone:N==null?void 0:N.phone}}}));if(F)throw F}await we()},Cr=async()=>{var u,a,d,m,D,V,Z,se;const t={full_name:q==null?void 0:q.full_name,phone:(q==null?void 0:q.phone)||null,email:(q==null?void 0:q.email)||null,department:q==null?void 0:q.department,role:"staff",is_active:!0,vendor_id:null,org_id:(q==null?void 0:q.org_id)||r||null};if(A){if(r&&(A!=null&&A.org_id)&&(A==null?void 0:A.org_id)!==r){if(!window.confirm("This staff profile belongs to another organization. Reassign to your org and continue editing?"))throw new Error("Edit cancelled. Staff belongs to another organization.");const{error:he}=await((d=(a=(u=P)==null?void 0:u.from("user_profiles"))==null?void 0:a.update({org_id:r,is_active:!0}))==null?void 0:d.eq("id",A==null?void 0:A.id));if(he)throw he}const{error:F}=await((V=(D=(m=P)==null?void 0:m.from("user_profiles"))==null?void 0:D.update(t))==null?void 0:V.eq("id",A==null?void 0:A.id));if(F)throw F}else{const{error:F}=await((se=(Z=P)==null?void 0:Z.from("user_profiles"))==null?void 0:se.insert([t]));if(F)throw F}await be()},vr=async()=>{var u,a,d,m,D;const t={name:k==null?void 0:k.name,contact_person:k==null?void 0:k.contact_person,phone:k==null?void 0:k.phone,email:k==null?void 0:k.email,specialty:k==null?void 0:k.specialty,rating:k!=null&&k.rating?parseFloat(k==null?void 0:k.rating):null};if(A){const{error:V}=await((d=(a=(u=P)==null?void 0:u.from("vendors"))==null?void 0:a.update(t))==null?void 0:d.eq("id",A==null?void 0:A.id));if(V)throw V}else{const{error:V}=await((D=(m=P)==null?void 0:m.from("vendors"))==null?void 0:D.insert([t]));if(V)throw V}await Te()},_r=async()=>{var u,a,d,m,D;const t={name:y==null?void 0:y.name,brand:y==null?void 0:y.brand,category:y==null?void 0:y.category,cost:y!=null&&y.cost?parseFloat(y==null?void 0:y.cost):0,unit_price:y!=null&&y.unit_price?parseFloat(y==null?void 0:y.unit_price):0,part_number:y==null?void 0:y.part_number,description:y==null?void 0:y.description,op_code:(y==null?void 0:y.op_code)||null};if(A){const{error:V}=await((d=(a=(u=P)==null?void 0:u.from("products"))==null?void 0:a.update(t))==null?void 0:d.eq("id",A==null?void 0:A.id));if(V)throw V}else{const{error:V}=await((D=(m=P)==null?void 0:m.from("products"))==null?void 0:D.insert([t]));if(V)throw V}await Re()},Sr=async()=>{var a,d,m,D,V;let t=O==null?void 0:O.message_template;if(!(t!=null&&t.startsWith("Stock #"))&&!(t!=null&&t.startsWith("{{stock"))&&(t="Stock #{{stock_number}}: "+t),(t==null?void 0:t.length)>160)throw new Error("SMS template must be under 160 characters");const u={name:O==null?void 0:O.name,message_template:t,template_type:O==null?void 0:O.template_type};if(A){const{error:Z}=await((m=(d=(a=P)==null?void 0:a.from("sms_templates"))==null?void 0:d.update(u))==null?void 0:m.eq("id",A==null?void 0:A.id));if(Z)throw Z}else{const{error:Z}=await((V=(D=P)==null?void 0:D.from("sms_templates"))==null?void 0:V.insert([u]));if(Z)throw Z}await lt()},Me=async(t,u,a=null)=>{var d,m,D,V,Z,se,F,de,he,Pe,Be,De,z,Ne,je,Le,Ce,Ie,Pt,Bt,Dt,Lt,It,Ut,$t,qt,zt,Vt,Ot,Qt,Gt,Ht,Kt;if(confirm("Are you sure you want to delete this item?")){_t(u),ee(!0);try{if(console.log(`Deleting from ${t} with id: ${u}`),t==="user_profiles"){console.log("Cleaning up foreign key dependencies...");const C=[(D=(m=(d=P)==null?void 0:d.from("jobs"))==null?void 0:m.update({assigned_to:null,created_by:null,delivery_coordinator_id:null}))==null?void 0:D.or(`assigned_to.eq.${u},created_by.eq.${u},delivery_coordinator_id.eq.${u}`)];C==null||C.push((se=(Z=(V=P)==null?void 0:V.from("transactions"))==null?void 0:Z.update({processed_by:null}))==null?void 0:se.eq("processed_by",u)),C==null||C.push((he=(de=(F=P)==null?void 0:F.from("vehicles"))==null?void 0:de.update({created_by:null}))==null?void 0:he.eq("created_by",u)),C==null||C.push((De=(Be=(Pe=P)==null?void 0:Pe.from("vendors"))==null?void 0:Be.update({created_by:null}))==null?void 0:De.eq("created_by",u)),C==null||C.push((je=(Ne=(z=P)==null?void 0:z.from("products"))==null?void 0:Ne.update({created_by:null}))==null?void 0:je.eq("created_by",u)),C==null||C.push((Ie=(Ce=(Le=P)==null?void 0:Le.from("sms_templates"))==null?void 0:Ce.update({created_by:null}))==null?void 0:Ie.eq("created_by",u)),C==null||C.push((Dt=(Bt=(Pt=P)==null?void 0:Pt.from("filter_presets"))==null?void 0:Bt.delete())==null?void 0:Dt.eq("user_id",u)),C==null||C.push((Ut=(It=(Lt=P)==null?void 0:Lt.from("notification_preferences"))==null?void 0:It.delete())==null?void 0:Ut.eq("user_id",u)),C==null||C.push((zt=(qt=($t=P)==null?void 0:$t.from("activity_history"))==null?void 0:qt.delete())==null?void 0:zt.eq("performed_by",u)),C==null||C.push((Qt=(Ot=(Vt=P)==null?void 0:Vt.from("communications"))==null?void 0:Ot.delete())==null?void 0:Qt.eq("sent_by",u)),await Promise.allSettled(C),console.log("Foreign key cleanup completed")}const{error:ge}=await((Kt=(Ht=(Gt=P)==null?void 0:Gt.from(t))==null?void 0:Ht.delete())==null?void 0:Kt.eq("id",u));if(ge)throw console.error("Delete operation failed:",ge),ge;console.log("Delete operation successful"),t==="user_profiles"?(a==="userAccount"?B(C=>{const Q=C==null?void 0:C.filter(J=>(J==null?void 0:J.id)!==u);return console.log(`User accounts updated: ${Q==null?void 0:Q.length} remaining`),Q||[]}):ce(C=>{const Q=C==null?void 0:C.filter(J=>(J==null?void 0:J.id)!==u);return console.log(`Staff records updated: ${Q==null?void 0:Q.length} remaining`),Q||[]}),setTimeout(async()=>{try{await Promise.all([we(),be()]),console.log("Data reloaded successfully after deletion")}catch(C){console.error("Error refreshing data after deletion:",C)}},500)):t==="vendors"?(re(C=>{const Q=C==null?void 0:C.filter(J=>(J==null?void 0:J.id)!==u);return console.log(`Vendors updated: ${Q==null?void 0:Q.length} remaining`),Q||[]}),setTimeout(async()=>{try{await Te(),console.log("Vendors reloaded successfully")}catch(C){console.error("Error refreshing vendors:",C)}},500)):t==="products"?(Ct(C=>{const Q=C==null?void 0:C.filter(J=>(J==null?void 0:J.id)!==u);return console.log(`Products updated: ${Q==null?void 0:Q.length} remaining`),Q||[]}),setTimeout(async()=>{try{await Re(),console.log("Products reloaded successfully")}catch(C){console.error("Error refreshing products:",C)}},500)):t==="sms_templates"&&(vt(C=>{const Q=C==null?void 0:C.filter(J=>(J==null?void 0:J.id)!==u);return console.log(`SMS templates updated: ${Q==null?void 0:Q.length} remaining`),Q||[]}),setTimeout(async()=>{try{await lt(),console.log("SMS templates reloaded successfully")}catch(C){console.error("Error refreshing SMS templates:",C)}},500)),console.log(`Successfully deleted item from ${t}`)}catch(ge){console.error("Error deleting item:",ge),alert("Error deleting item: "+((ge==null?void 0:ge.message)||"Unknown error")),setTimeout(async()=>{try{await Et(),console.log("All data reloaded after error")}catch(C){console.error("Error refreshing all data after deletion error:",C)}},1e3)}finally{ee(!1),_t(null)}}},Er=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["User Accounts (",E.length,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-blue-600 appearance-auto",checked:j,onChange:t=>b(t.target.checked)}),e.jsx("span",{className:"text-sm",children:"Only my org"})]}),e.jsxs(Y,{onClick:yr,disabled:!r||le,className:"bg-emerald-600 hover:bg-emerald-700 text-white flex items-center gap-2 disabled:opacity-50",children:[e.jsx(ue,{className:"w-4 h-4"}),"Assign Org to Accounts"]}),e.jsxs(Y,{onClick:()=>ae("userAccount"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add User Account"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Org"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Org"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E==null?void 0:E.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t==null?void 0:t.full_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t==null?void 0:t.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${(t==null?void 0:t.role)==="admin"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:t==null?void 0:t.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t==null?void 0:t.department}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:t!=null&&t.org_id?String(t==null?void 0:t.org_id).slice(0,8):""}),r&&(t!=null&&t.org_id)&&(t==null?void 0:t.org_id)!==r?e.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full bg-yellow-100 text-yellow-800",children:"Other org"}):null]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:t!=null&&t.org_id?String(t==null?void 0:t.org_id).slice(0,8):""}),r&&(t!=null&&t.org_id)&&(t==null?void 0:t.org_id)!==r?e.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full bg-yellow-100 text-yellow-800",children:"Other org"}):null]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t!=null&&t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t!=null&&t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae("userAccount",t),className:`text-blue-600 hover:text-blue-900 ${r&&(t!=null&&t.org_id)&&(t==null?void 0:t.org_id)!==r?"opacity-50 cursor-not-allowed":""}`,disabled:!!(r&&(t!=null&&t.org_id)&&(t==null?void 0:t.org_id)!==r),title:r&&(t!=null&&t.org_id)&&(t==null?void 0:t.org_id)!==r?"Account belongs to another org  you cannot edit it here":"Edit user",children:e.jsx($e,{className:"w-4 h-4"})}),r&&(t==null?void 0:t.org_id)&&(t==null?void 0:t.org_id)!==r&&e.jsx("button",{title:"Attach to my org",onClick:()=>it(t==null?void 0:t.id),className:"text-emerald-600 hover:text-emerald-800 disabled:opacity-50",disabled:le,children:e.jsx(ue,{className:"w-4 h-4"})}),r&&(t==null?void 0:t.org_id)&&(t==null?void 0:t.org_id)!==r&&e.jsx("button",{title:"Attach to my org",onClick:()=>it(t==null?void 0:t.id),className:"text-emerald-600 hover:text-emerald-800 disabled:opacity-50",disabled:le,children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Me("user_profiles",t==null?void 0:t.id,"userAccount"),disabled:Ae===(t==null?void 0:t.id),className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]},t==null?void 0:t.id))})]})}),(E==null?void 0:E.length)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No user accounts found. Click "Add User Account" to create one.'}),G?e.jsx("div",{className:"mt-3 p-3 rounded bg-blue-50 text-blue-700",children:G}):null]}),Ar=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Staff Records (",$.length,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-blue-600 appearance-auto",checked:j,onChange:t=>b(t.target.checked)}),e.jsx("span",{className:"text-sm",children:"Only my org"})]}),e.jsxs(Y,{onClick:pr,disabled:!r||le,className:"bg-emerald-600 hover:bg-emerald-700 text-white flex items-center gap-2 disabled:opacity-50",children:[e.jsx(ue,{className:"w-4 h-4"}),"Assign Org to Staff"]}),e.jsxs(Y,{onClick:()=>ae("staff"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add Staff Member"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Org"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:$==null?void 0:$.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t==null?void 0:t.full_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${(t==null?void 0:t.department)==="Sales Consultants"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:t==null?void 0:t.department})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.phone)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.email)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{children:t!=null&&t.org_id?String(t==null?void 0:t.org_id).slice(0,8):""}),r&&(t!=null&&t.org_id)&&(t==null?void 0:t.org_id)!==r?e.jsx("span",{className:"inline-flex px-2 py-0.5 text-xs rounded-full bg-yellow-100 text-yellow-800",children:"Other org"}):null]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t!=null&&t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t!=null&&t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae("staff",t),className:`text-blue-600 hover:text-blue-900 ${r&&(t!=null&&t.org_id)&&(t==null?void 0:t.org_id)!==r?"opacity-50 cursor-not-allowed":""}`,disabled:!!(r&&(t!=null&&t.org_id)&&(t==null?void 0:t.org_id)!==r),title:r&&(t!=null&&t.org_id)&&(t==null?void 0:t.org_id)!==r?"Staff belongs to another org  attach to your org to edit":"Edit staff",children:e.jsx($e,{className:"w-4 h-4"})}),r&&(t==null?void 0:t.org_id)&&(t==null?void 0:t.org_id)!==r&&e.jsx("button",{title:"Attach to my org",onClick:()=>it(t==null?void 0:t.id),className:"text-emerald-600 hover:text-emerald-800 disabled:opacity-50",disabled:le,children:e.jsx(ue,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Me("user_profiles",t==null?void 0:t.id,"staff"),disabled:Ae===(t==null?void 0:t.id),className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]},t==null?void 0:t.id))})]})}),($==null?void 0:$.length)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No staff records found. Click "Add Staff Member" to create one.'}),T?e.jsx("div",{className:"mt-3 p-3 rounded bg-blue-50 text-blue-700",children:T}):null]}),kr=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Vendors (",K.length,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-blue-600 appearance-auto",checked:j,onChange:t=>b(t.target.checked)}),e.jsx("span",{className:"text-sm",children:"Only my org"})]}),e.jsxs(Y,{onClick:wr,disabled:!r||le,className:"bg-emerald-600 hover:bg-emerald-700 text-white flex items-center gap-2 disabled:opacity-50",children:[e.jsx(ue,{className:"w-4 h-4"}),"Assign Org to Vendors"]}),e.jsxs(Y,{onClick:()=>ae("vendor"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add Vendor"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact Person"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Specialty"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rating"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:K==null?void 0:K.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t==null?void 0:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.contact_person)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.phone)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.specialty)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t!=null&&t.rating?`${t==null?void 0:t.rating}/5`:"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t!=null&&t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t!=null&&t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae("vendor",t),className:"text-blue-600 hover:text-blue-900",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Me("vendors",t==null?void 0:t.id),disabled:Ae===(t==null?void 0:t.id),className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]},t==null?void 0:t.id))})]})}),(K==null?void 0:K.length)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No vendors found. Click "Add Vendor" to create one.'}),R?e.jsx("div",{className:"mt-3 p-3 rounded bg-blue-50 text-blue-700",children:R}):null]}),Tr=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Aftermarket Products (",X.length,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-blue-600 appearance-auto",checked:j,onChange:t=>b(t.target.checked)}),e.jsx("span",{className:"text-sm",children:"Only my org"})]}),e.jsxs(Y,{onClick:br,disabled:!r||le,className:"bg-emerald-600 hover:bg-emerald-700 text-white flex items-center gap-2 disabled:opacity-50",children:[e.jsx(ue,{className:"w-4 h-4"}),"Assign Org to Products"]}),e.jsxs(Y,{onClick:()=>ae("product"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add Product"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Brand"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Op Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:X==null?void 0:X.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t==null?void 0:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.brand)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.category)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-mono bg-gray-100 text-gray-800 rounded",children:(t==null?void 0:t.op_code)||"N/A"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",(t==null?void 0:t.cost)||"0.00"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",(t==null?void 0:t.unit_price)||"0.00"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t!=null&&t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t!=null&&t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae("product",t),className:"text-blue-600 hover:text-blue-900",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Me("products",t==null?void 0:t.id),disabled:Ae===(t==null?void 0:t.id),className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]},t==null?void 0:t.id))})]})}),(X==null?void 0:X.length)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No products found. Click "Add Product" to create one.'}),S?e.jsx("div",{className:"mt-3 p-3 rounded bg-blue-50 text-blue-700",children:S}):null]}),Rr=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["SMS Templates (",(W==null?void 0:W.length)||0,")"]}),e.jsxs(Y,{onClick:()=>ae("template"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add Template"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Message Preview"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W==null?void 0:W.map(t=>{var u;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t==null?void 0:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:(u=t==null?void 0:t.template_type)==null?void 0:u.replace("_"," ")})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:t==null?void 0:t.message_template}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t!=null&&t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t!=null&&t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae("template",t),className:"text-blue-600 hover:text-blue-900",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Me("sms_templates",t==null?void 0:t.id),disabled:Ae===(t==null?void 0:t.id),className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]},t==null?void 0:t.id)})})]})}),(W==null?void 0:W.length)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No SMS templates found. Click "Add Template" to create one.'})]}),Mr=()=>{var u;const t=`${(u=window==null?void 0:window.location)==null?void 0:u.origin}/guest-claims-submission-form`;return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"QR Code Generator"}),e.jsx("p",{className:"text-gray-600",children:"Generate QR codes for easy access to your guest claims form and other important links."})]}),e.jsx("div",{children:e.jsx(Ps,{url:t,title:"Guest Claims Submission Form",description:"Generate a QR code for customers to quickly access your guest claims form. Perfect for printing on business cards, flyers, or displaying in your shop.",size:250,showControls:!0})}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"How to Use QR Codes:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm text-blue-800",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2",children:" For Customers:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:" Open camera app on smartphone"}),e.jsx("li",{children:" Point camera at QR code"}),e.jsx("li",{children:" Tap notification to open claims form"}),e.jsx("li",{children:" No app download required"})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2",children:" For Your Business:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:" Download and print QR codes"}),e.jsx("li",{children:" Add to business cards"}),e.jsx("li",{children:" Display in waiting areas"}),e.jsx("li",{children:" Include in email signatures"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"QR Code Benefits:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"95%"}),e.jsx("div",{className:"text-gray-600",children:"Smartphone QR Support"})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"3x"}),e.jsx("div",{className:"text-gray-600",children:"Faster Than Typing URLs"})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"100%"}),e.jsx("div",{className:"text-gray-600",children:"Contactless Access"})]})]})]})]})},Pr=()=>{var u;if(!mr)return null;const t=()=>{switch(ne){case"userAccount":return A?"Edit User Account":"Add User Account";case"staff":return A?"Edit Staff Member":"Add Staff Member";case"vendor":return A?"Edit Vendor":"Add Vendor";case"product":return A?"Edit Product":"Add Product";case"template":return A?"Edit SMS Template":"Add SMS Template";default:return"Form"}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:t()}),e.jsx("button",{onClick:()=>Qe(!1),className:"text-gray-400 hover:text-gray-600",children:""})]}),e.jsxs("form",{onSubmit:Nr,className:"space-y-4",children:[ne==="userAccount"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{label:"Full Name",value:N==null?void 0:N.full_name,onChange:a=>{var d;return fe({...N,full_name:(d=a==null?void 0:a.target)==null?void 0:d.value})},required:!0}),e.jsx(H,{label:"Email",type:"email",value:N==null?void 0:N.email,onChange:a=>{var d;return fe({...N,email:(d=a==null?void 0:a.target)==null?void 0:d.value})},required:!0}),!A&&e.jsx(H,{label:"Password",type:"password",value:N==null?void 0:N.password,onChange:a=>{var d;return fe({...N,password:(d=a==null?void 0:a.target)==null?void 0:d.value})},required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsx("select",{value:N==null?void 0:N.role,onChange:a=>{var d;return fe({...N,role:(d=a==null?void 0:a.target)==null?void 0:d.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:rt==null?void 0:rt.map(a=>e.jsx("option",{value:a==null?void 0:a.value,children:a==null?void 0:a.label},a==null?void 0:a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsxs("select",{value:N==null?void 0:N.department,onChange:a=>{var d;return fe({...N,department:(d=a==null?void 0:a.target)==null?void 0:d.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select Department"}),st==null?void 0:st.map(a=>e.jsx("option",{value:a==null?void 0:a.value,children:a==null?void 0:a.label},a==null?void 0:a.value))]})]}),e.jsx(H,{label:"Phone",value:N==null?void 0:N.phone,onChange:a=>{var d;return fe({...N,phone:(d=a==null?void 0:a.target)==null?void 0:d.value})}})]}),ne==="staff"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{label:"Full Name",value:q==null?void 0:q.full_name,onChange:a=>{var d;return ke({...q,full_name:(d=a==null?void 0:a.target)==null?void 0:d.value})},required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsxs("select",{value:q==null?void 0:q.department,onChange:a=>{var d;return ke({...q,department:(d=a==null?void 0:a.target)==null?void 0:d.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select Department"}),nt==null?void 0:nt.map(a=>e.jsx("option",{value:a==null?void 0:a.value,children:a==null?void 0:a.label},a==null?void 0:a.value))]})]}),e.jsx(H,{label:"Phone",value:q==null?void 0:q.phone,onChange:a=>{var d;return ke({...q,phone:(d=a==null?void 0:a.target)==null?void 0:d.value})}}),e.jsx(H,{label:"Email",type:"email",value:q==null?void 0:q.email,onChange:a=>{var d;return ke({...q,email:(d=a==null?void 0:a.target)==null?void 0:d.value})}})]}),ne==="vendor"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{label:"Vendor Name",value:k==null?void 0:k.name,onChange:a=>{var d;return pe({...k,name:(d=a==null?void 0:a.target)==null?void 0:d.value})},required:!0}),e.jsx(H,{label:"Contact Person",value:k==null?void 0:k.contact_person,onChange:a=>{var d;return pe({...k,contact_person:(d=a==null?void 0:a.target)==null?void 0:d.value})}}),e.jsx(H,{label:"Phone",value:k==null?void 0:k.phone,onChange:a=>{var d;return pe({...k,phone:(d=a==null?void 0:a.target)==null?void 0:d.value})}}),e.jsx(H,{label:"Email",type:"email",value:k==null?void 0:k.email,onChange:a=>{var d;return pe({...k,email:(d=a==null?void 0:a.target)==null?void 0:d.value})}}),e.jsx(H,{label:"Specialty",value:k==null?void 0:k.specialty,onChange:a=>{var d;return pe({...k,specialty:(d=a==null?void 0:a.target)==null?void 0:d.value})}}),e.jsx(H,{label:"Rating (1-5)",type:"number",min:"1",max:"5",step:"0.1",value:k==null?void 0:k.rating,onChange:a=>{var d;return pe({...k,rating:(d=a==null?void 0:a.target)==null?void 0:d.value})}})]}),ne==="product"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{label:"Product Name",value:y==null?void 0:y.name,onChange:a=>{var d;return oe({...y,name:(d=a==null?void 0:a.target)==null?void 0:d.value})},required:!0}),e.jsx(H,{label:"Brand",value:y==null?void 0:y.brand,onChange:a=>{var d;return oe({...y,brand:(d=a==null?void 0:a.target)==null?void 0:d.value})}}),e.jsx(H,{label:"Category",value:y==null?void 0:y.category,onChange:a=>{var d;return oe({...y,category:(d=a==null?void 0:a.target)==null?void 0:d.value})}}),e.jsx(H,{label:"Op Code",value:y==null?void 0:y.op_code,onChange:a=>{var d;return oe({...y,op_code:(d=a==null?void 0:a.target)==null?void 0:d.value})},placeholder:"e.g., EN3, EN5"}),e.jsx(H,{label:"Cost",type:"number",step:"0.01",value:y==null?void 0:y.cost,onChange:a=>{var d;return oe({...y,cost:(d=a==null?void 0:a.target)==null?void 0:d.value})},required:!0}),e.jsx(H,{label:"Unit Price",type:"number",step:"0.01",value:y==null?void 0:y.unit_price,onChange:a=>{var d;return oe({...y,unit_price:(d=a==null?void 0:a.target)==null?void 0:d.value})},required:!0}),e.jsx(H,{label:"Part Number",value:y==null?void 0:y.part_number,onChange:a=>{var d;return oe({...y,part_number:(d=a==null?void 0:a.target)==null?void 0:d.value})}}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:y==null?void 0:y.description,onChange:a=>{var d;return oe({...y,description:(d=a==null?void 0:a.target)==null?void 0:d.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:"3"})]})]}),ne==="template"&&e.jsxs(e.Fragment,{children:[e.jsx(H,{label:"Template Name",value:O==null?void 0:O.name,onChange:a=>{var d;return Ge({...O,name:(d=a==null?void 0:a.target)==null?void 0:d.value})},required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template Type"}),e.jsx("select",{value:O==null?void 0:O.template_type,onChange:a=>{var d;return Ge({...O,template_type:(d=a==null?void 0:a.target)==null?void 0:d.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:at==null?void 0:at.map(a=>e.jsx("option",{value:a==null?void 0:a.value,children:a==null?void 0:a.label},a==null?void 0:a.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Message Template (",((u=O==null?void 0:O.message_template)==null?void 0:u.length)||0,"/160)"]}),e.jsx("textarea",{value:O==null?void 0:O.message_template,onChange:a=>{var d;return Ge({...O,message_template:(d=a==null?void 0:a.target)==null?void 0:d.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:"4",maxLength:"160",placeholder:"Use {{stock_number}}, {{vehicle_info}}, {{status}} as variables",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(Y,{type:"button",onClick:()=>Qe(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200",children:"Cancel"}),e.jsx(Y,{type:"submit",disabled:le,className:"px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:le?"Saving...":A?"Update":"Create"})]})]})]})})};return c?e.jsx(ot,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading admin panel..."})]})})}):f?e.jsx(ot,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Zt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Admin Panel Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:f}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Y,{onClick:()=>{var t;return(t=window.location)==null?void 0:t.reload()},className:"w-full bg-blue-600 hover:bg-blue-700 text-white flex items-center justify-center gap-2",children:[e.jsx($r,{className:"w-4 h-4"}),"Refresh Page"]}),e.jsx(Y,{onClick:fr,className:"w-full bg-gray-600 hover:bg-gray-700 text-white",children:"Debug Connection"}),e.jsx(Y,{onClick:()=>window.location.href="/authentication-portal",className:"w-full bg-green-600 hover:bg-green-700 text-white",children:"Go to Login"})]}),(x==null?void 0:x.showDebug)&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg text-left text-sm",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Debug Information:"}),e.jsxs("div",{className:"space-y-1 font-mono text-xs",children:[e.jsxs("div",{children:["Auth User: ",((At=x==null?void 0:x.authUser)==null?void 0:At.email)||"None"]}),e.jsxs("div",{children:["User ID: ",((kt=x==null?void 0:x.authUser)==null?void 0:kt.id)||"None"]}),e.jsxs("div",{children:["Profile Found: ",x!=null&&x.userProfile?"Yes":"No"]}),e.jsxs("div",{children:["User Role: ",((Tt=x==null?void 0:x.userProfile)==null?void 0:Tt.role)||"None"]}),e.jsxs("div",{children:["Department: ",((Rt=x==null?void 0:x.userProfile)==null?void 0:Rt.department)||"None"]}),(x==null?void 0:x.profileLoadError)&&e.jsxs("div",{className:"text-red-600 mt-2",children:["Error: ",(Mt=x==null?void 0:x.profileLoadError)==null?void 0:Mt.message]})]})]})]})})})}):e.jsx(ot,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Panel"}),e.jsx("p",{className:"text-gray-600",children:"Complete administrative management for Priority Automotive Tracker"}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"System Status"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Auth Status:"}),e.jsx("span",{className:`ml-1 ${s?"text-green-600":"text-orange-600"}`,children:s?"Authenticated":"Demo Mode"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"User Role:"}),e.jsx("span",{className:"ml-1 text-blue-600",children:(n==null?void 0:n.role)||"Admin"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Access Level:"}),e.jsx("span",{className:"ml-1 text-green-600",children:"Full Access"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Database:"}),e.jsx("span",{className:"ml-1 text-green-600",children:"Connected"})]})]})]})]}),e.jsxs("div",{className:"mb-8 p-4 bg-white border border-gray-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Current Data Status"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"User Accounts:"}),e.jsxs("span",{className:`ml-1 ${(E==null?void 0:E.length)>0?"text-green-600":"text-red-600"}`,children:[(E==null?void 0:E.length)||0," found"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Staff Records:"}),e.jsxs("span",{className:`ml-1 ${($==null?void 0:$.length)>0?"text-green-600":"text-red-600"}`,children:[($==null?void 0:$.length)||0," found"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Vendors:"}),e.jsxs("span",{className:`ml-1 ${(K==null?void 0:K.length)>0?"text-green-600":"text-red-600"}`,children:[(K==null?void 0:K.length)||0," found"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Products:"}),e.jsxs("span",{className:`ml-1 ${(X==null?void 0:X.length)>0?"text-green-600":"text-red-600"}`,children:[(X==null?void 0:X.length)||0," found"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"SMS Templates:"}),e.jsxs("span",{className:`ml-1 ${(W==null?void 0:W.length)>0?"text-green-600":"text-red-600"}`,children:[(W==null?void 0:W.length)||0," found"]})]})]})]}),e.jsx("div",{className:"mb-8",children:e.jsx("nav",{className:"flex space-x-8 border-b border-gray-200",children:tt==null?void 0:tt.map(t=>{const u=t==null?void 0:t.icon;let a=0;return(t==null?void 0:t.id)==="userAccounts"&&(a=(E==null?void 0:E.length)||0),(t==null?void 0:t.id)==="staffRecords"&&(a=($==null?void 0:$.length)||0),(t==null?void 0:t.id)==="vendors"&&(a=(K==null?void 0:K.length)||0),(t==null?void 0:t.id)==="products"&&(a=(X==null?void 0:X.length)||0),(t==null?void 0:t.id)==="smsTemplates"&&(a=(W==null?void 0:W.length)||0),(t==null?void 0:t.id)==="qrCodes"&&(a=null),e.jsxs("button",{onClick:()=>w(t==null?void 0:t.id),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm ${h===(t==null?void 0:t.id)?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(u,{className:"w-5 h-5"}),t==null?void 0:t.label,a!==null&&e.jsx("span",{className:`ml-1 px-2 py-1 text-xs rounded-full ${a>0?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500"}`,children:a})]},t==null?void 0:t.id)})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[h==="userAccounts"&&Er(),h==="staffRecords"&&Ar(),h==="vendors"&&kr(),h==="products"&&Tr(),h==="smsTemplates"&&Rr(),h==="qrCodes"&&Mr()]})]}),Pr()]})})};export{Vs as default};
//# sourceMappingURL=index-4FsRRGe8.js.map
