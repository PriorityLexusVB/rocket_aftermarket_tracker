import{j as e,ac as Je,a5 as Zt,B as Y,_ as Bs,x as Ds,Z as Ls,ad as Is,u as Us,s as R,R as $s,ae as qs,y as Vs,af as ye,N as zs,W as Qs,h as K,ag as Ue,ah as $e,ai as qe}from"./index-Cilu4N9n.js";import{r as D}from"./react-Czq5O75u.js";import{u as Os}from"./useTenant-BagYas1t.js";import{A as it}from"./AppLayout-BDiw3-38.js";import{u as Gs}from"./useLogger-D0Z8mEND.js";import"./supabase-D02rA7zj.js";import"./router-CZES1Sa0.js";import"./Navbar-SqbdiSOm.js";var we={},Hs=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},Xt={},ee={};let pt;const Ks=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];ee.getSymbolSize=function(s){if(!s)throw new Error('"version" cannot be null or undefined');if(s<1||s>40)throw new Error('"version" should be in range from 1 to 40');return s*4+17};ee.getSymbolTotalCodewords=function(s){return Ks[s]};ee.getBCHDigit=function(n){let s=0;for(;n!==0;)s++,n>>>=1;return s};ee.setToSJISFunction=function(s){if(typeof s!="function")throw new Error('"toSJISFunc" is not a valid function.');pt=s};ee.isKanjiModeEnabled=function(){return typeof pt<"u"};ee.toSJIS=function(s){return pt(s)};var Ze={};(function(n){n.L={bit:1},n.M={bit:0},n.Q={bit:3},n.H={bit:2};function s(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"l":case"low":return n.L;case"m":case"medium":return n.M;case"q":case"quartile":return n.Q;case"h":case"high":return n.H;default:throw new Error("Unknown EC Level: "+o)}}n.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},n.from=function(r,l){if(n.isValid(r))return r;try{return s(r)}catch{return l}}})(Ze);function Ft(){this.buffer=[],this.length=0}Ft.prototype={get:function(n){const s=Math.floor(n/8);return(this.buffer[s]>>>7-n%8&1)===1},put:function(n,s){for(let o=0;o<s;o++)this.putBit((n>>>s-o-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const s=Math.floor(this.length/8);this.buffer.length<=s&&this.buffer.push(0),n&&(this.buffer[s]|=128>>>this.length%8),this.length++}};var Js=Ft;function Qe(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}Qe.prototype.set=function(n,s,o,r){const l=n*this.size+s;this.data[l]=o,r&&(this.reservedBit[l]=!0)};Qe.prototype.get=function(n,s){return this.data[n*this.size+s]};Qe.prototype.xor=function(n,s,o){this.data[n*this.size+s]^=o};Qe.prototype.isReserved=function(n,s){return this.reservedBit[n*this.size+s]};var Ys=Qe,es={};(function(n){const s=ee.getSymbolSize;n.getRowColCoords=function(r){if(r===1)return[];const l=Math.floor(r/7)+2,i=s(r),d=i===145?26:Math.ceil((i-13)/(2*l-2))*2,h=[i-7];for(let u=1;u<l-1;u++)h[u]=h[u-1]-d;return h.push(6),h.reverse()},n.getPositions=function(r){const l=[],i=n.getRowColCoords(r),d=i.length;for(let h=0;h<d;h++)for(let u=0;u<d;u++)h===0&&u===0||h===0&&u===d-1||h===d-1&&u===0||l.push([i[h],i[u]]);return l}})(es);var ts={};const Ws=ee.getSymbolSize,Jt=7;ts.getPositions=function(s){const o=Ws(s);return[[0,0],[o-Jt,0],[0,o-Jt]]};var ss={};(function(n){n.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const s={N1:3,N2:3,N3:40,N4:10};n.isValid=function(l){return l!=null&&l!==""&&!isNaN(l)&&l>=0&&l<=7},n.from=function(l){return n.isValid(l)?parseInt(l,10):void 0},n.getPenaltyN1=function(l){const i=l.size;let d=0,h=0,u=0,b=null,p=null;for(let $=0;$<i;$++){h=u=0,b=p=null;for(let j=0;j<i;j++){let N=l.get($,j);N===b?h++:(h>=5&&(d+=s.N1+(h-5)),b=N,h=1),N=l.get(j,$),N===p?u++:(u>=5&&(d+=s.N1+(u-5)),p=N,u=1)}h>=5&&(d+=s.N1+(h-5)),u>=5&&(d+=s.N1+(u-5))}return d},n.getPenaltyN2=function(l){const i=l.size;let d=0;for(let h=0;h<i-1;h++)for(let u=0;u<i-1;u++){const b=l.get(h,u)+l.get(h,u+1)+l.get(h+1,u)+l.get(h+1,u+1);(b===4||b===0)&&d++}return d*s.N2},n.getPenaltyN3=function(l){const i=l.size;let d=0,h=0,u=0;for(let b=0;b<i;b++){h=u=0;for(let p=0;p<i;p++)h=h<<1&2047|l.get(b,p),p>=10&&(h===1488||h===93)&&d++,u=u<<1&2047|l.get(p,b),p>=10&&(u===1488||u===93)&&d++}return d*s.N3},n.getPenaltyN4=function(l){let i=0;const d=l.data.length;for(let u=0;u<d;u++)i+=l.data[u];return Math.abs(Math.ceil(i*100/d/5)-10)*s.N4};function o(r,l,i){switch(r){case n.Patterns.PATTERN000:return(l+i)%2===0;case n.Patterns.PATTERN001:return l%2===0;case n.Patterns.PATTERN010:return i%3===0;case n.Patterns.PATTERN011:return(l+i)%3===0;case n.Patterns.PATTERN100:return(Math.floor(l/2)+Math.floor(i/3))%2===0;case n.Patterns.PATTERN101:return l*i%2+l*i%3===0;case n.Patterns.PATTERN110:return(l*i%2+l*i%3)%2===0;case n.Patterns.PATTERN111:return(l*i%3+(l+i)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}n.applyMask=function(l,i){const d=i.size;for(let h=0;h<d;h++)for(let u=0;u<d;u++)i.isReserved(u,h)||i.xor(u,h,o(l,u,h))},n.getBestMask=function(l,i){const d=Object.keys(n.Patterns).length;let h=0,u=1/0;for(let b=0;b<d;b++){i(b),n.applyMask(b,l);const p=n.getPenaltyN1(l)+n.getPenaltyN2(l)+n.getPenaltyN3(l)+n.getPenaltyN4(l);n.applyMask(b,l),p<u&&(u=p,h=b)}return h}})(ss);var Xe={};const me=Ze,He=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Ke=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Xe.getBlocksCount=function(s,o){switch(o){case me.L:return He[(s-1)*4+0];case me.M:return He[(s-1)*4+1];case me.Q:return He[(s-1)*4+2];case me.H:return He[(s-1)*4+3];default:return}};Xe.getTotalCodewordsCount=function(s,o){switch(o){case me.L:return Ke[(s-1)*4+0];case me.M:return Ke[(s-1)*4+1];case me.Q:return Ke[(s-1)*4+2];case me.H:return Ke[(s-1)*4+3];default:return}};var rs={},Fe={};const Ve=new Uint8Array(512),Ye=new Uint8Array(256);(function(){let s=1;for(let o=0;o<255;o++)Ve[o]=s,Ye[s]=o,s<<=1,s&256&&(s^=285);for(let o=255;o<512;o++)Ve[o]=Ve[o-255]})();Fe.log=function(s){if(s<1)throw new Error("log("+s+")");return Ye[s]};Fe.exp=function(s){return Ve[s]};Fe.mul=function(s,o){return s===0||o===0?0:Ve[Ye[s]+Ye[o]]};(function(n){const s=Fe;n.mul=function(r,l){const i=new Uint8Array(r.length+l.length-1);for(let d=0;d<r.length;d++)for(let h=0;h<l.length;h++)i[d+h]^=s.mul(r[d],l[h]);return i},n.mod=function(r,l){let i=new Uint8Array(r);for(;i.length-l.length>=0;){const d=i[0];for(let u=0;u<l.length;u++)i[u]^=s.mul(l[u],d);let h=0;for(;h<i.length&&i[h]===0;)h++;i=i.slice(h)}return i},n.generateECPolynomial=function(r){let l=new Uint8Array([1]);for(let i=0;i<r;i++)l=n.mul(l,new Uint8Array([1,s.exp(i)]));return l}})(rs);const ns=rs;function yt(n){this.genPoly=void 0,this.degree=n,this.degree&&this.initialize(this.degree)}yt.prototype.initialize=function(s){this.degree=s,this.genPoly=ns.generateECPolynomial(this.degree)};yt.prototype.encode=function(s){if(!this.genPoly)throw new Error("Encoder not initialized");const o=new Uint8Array(s.length+this.degree);o.set(s);const r=ns.mod(o,this.genPoly),l=this.degree-r.length;if(l>0){const i=new Uint8Array(this.degree);return i.set(r,l),i}return r};var Zs=yt,as={},xe={},wt={};wt.isValid=function(s){return!isNaN(s)&&s>=1&&s<=40};var le={};const ls="[0-9]+",Xs="[A-Z $%*+\\-./:]+";let ze="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";ze=ze.replace(/u/g,"\\u");const Fs="(?:(?![A-Z0-9 $%*+\\-./:]|"+ze+`)(?:.|[\r
]))+`;le.KANJI=new RegExp(ze,"g");le.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");le.BYTE=new RegExp(Fs,"g");le.NUMERIC=new RegExp(ls,"g");le.ALPHANUMERIC=new RegExp(Xs,"g");const er=new RegExp("^"+ze+"$"),tr=new RegExp("^"+ls+"$"),sr=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");le.testKanji=function(s){return er.test(s)};le.testNumeric=function(s){return tr.test(s)};le.testAlphanumeric=function(s){return sr.test(s)};(function(n){const s=wt,o=le;n.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},n.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},n.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},n.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},n.MIXED={bit:-1},n.getCharCountIndicator=function(i,d){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!s.isValid(d))throw new Error("Invalid version: "+d);return d>=1&&d<10?i.ccBits[0]:d<27?i.ccBits[1]:i.ccBits[2]},n.getBestModeForData=function(i){return o.testNumeric(i)?n.NUMERIC:o.testAlphanumeric(i)?n.ALPHANUMERIC:o.testKanji(i)?n.KANJI:n.BYTE},n.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},n.isValid=function(i){return i&&i.bit&&i.ccBits};function r(l){if(typeof l!="string")throw new Error("Param is not a string");switch(l.toLowerCase()){case"numeric":return n.NUMERIC;case"alphanumeric":return n.ALPHANUMERIC;case"kanji":return n.KANJI;case"byte":return n.BYTE;default:throw new Error("Unknown mode: "+l)}}n.from=function(i,d){if(n.isValid(i))return i;try{return r(i)}catch{return d}}})(xe);(function(n){const s=ee,o=Xe,r=Ze,l=xe,i=wt,d=7973,h=s.getBCHDigit(d);function u(j,N,k){for(let y=1;y<=40;y++)if(N<=n.getCapacity(y,k,j))return y}function b(j,N){return l.getCharCountIndicator(j,N)+4}function p(j,N){let k=0;return j.forEach(function(y){const G=b(y.mode,N);k+=G+y.getBitsLength()}),k}function $(j,N){for(let k=1;k<=40;k++)if(p(j,k)<=n.getCapacity(k,N,l.MIXED))return k}n.from=function(N,k){return i.isValid(N)?parseInt(N,10):k},n.getCapacity=function(N,k,y){if(!i.isValid(N))throw new Error("Invalid QR Code version");typeof y>"u"&&(y=l.BYTE);const G=s.getSymbolTotalCodewords(N),_=o.getTotalCodewordsCount(N,k),T=(G-_)*8;if(y===l.MIXED)return T;const v=T-b(y,N);switch(y){case l.NUMERIC:return Math.floor(v/10*3);case l.ALPHANUMERIC:return Math.floor(v/11*2);case l.KANJI:return Math.floor(v/13);case l.BYTE:default:return Math.floor(v/8)}},n.getBestVersionForData=function(N,k){let y;const G=r.from(k,r.M);if(Array.isArray(N)){if(N.length>1)return $(N,G);if(N.length===0)return 1;y=N[0]}else y=N;return u(y.mode,y.getLength(),G)},n.getEncodedBits=function(N){if(!i.isValid(N)||N<7)throw new Error("Invalid QR Code version");let k=N<<12;for(;s.getBCHDigit(k)-h>=0;)k^=d<<s.getBCHDigit(k)-h;return N<<12|k}})(as);var is={};const gt=ee,os=1335,rr=21522,Yt=gt.getBCHDigit(os);is.getEncodedBits=function(s,o){const r=s.bit<<3|o;let l=r<<10;for(;gt.getBCHDigit(l)-Yt>=0;)l^=os<<gt.getBCHDigit(l)-Yt;return(r<<10|l)^rr};var cs={};const nr=xe;function _e(n){this.mode=nr.NUMERIC,this.data=n.toString()}_e.getBitsLength=function(s){return 10*Math.floor(s/3)+(s%3?s%3*3+1:0)};_e.prototype.getLength=function(){return this.data.length};_e.prototype.getBitsLength=function(){return _e.getBitsLength(this.data.length)};_e.prototype.write=function(s){let o,r,l;for(o=0;o+3<=this.data.length;o+=3)r=this.data.substr(o,3),l=parseInt(r,10),s.put(l,10);const i=this.data.length-o;i>0&&(r=this.data.substr(o),l=parseInt(r,10),s.put(l,i*3+1))};var ar=_e;const lr=xe,ot=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Se(n){this.mode=lr.ALPHANUMERIC,this.data=n}Se.getBitsLength=function(s){return 11*Math.floor(s/2)+6*(s%2)};Se.prototype.getLength=function(){return this.data.length};Se.prototype.getBitsLength=function(){return Se.getBitsLength(this.data.length)};Se.prototype.write=function(s){let o;for(o=0;o+2<=this.data.length;o+=2){let r=ot.indexOf(this.data[o])*45;r+=ot.indexOf(this.data[o+1]),s.put(r,11)}this.data.length%2&&s.put(ot.indexOf(this.data[o]),6)};var ir=Se;const or=xe;function Ee(n){this.mode=or.BYTE,typeof n=="string"?this.data=new TextEncoder().encode(n):this.data=new Uint8Array(n)}Ee.getBitsLength=function(s){return s*8};Ee.prototype.getLength=function(){return this.data.length};Ee.prototype.getBitsLength=function(){return Ee.getBitsLength(this.data.length)};Ee.prototype.write=function(n){for(let s=0,o=this.data.length;s<o;s++)n.put(this.data[s],8)};var cr=Ee;const dr=xe,ur=ee;function Ae(n){this.mode=dr.KANJI,this.data=n}Ae.getBitsLength=function(s){return s*13};Ae.prototype.getLength=function(){return this.data.length};Ae.prototype.getBitsLength=function(){return Ae.getBitsLength(this.data.length)};Ae.prototype.write=function(n){let s;for(s=0;s<this.data.length;s++){let o=ur.toSJIS(this.data[s]);if(o>=33088&&o<=40956)o-=33088;else if(o>=57408&&o<=60351)o-=49472;else throw new Error("Invalid SJIS character: "+this.data[s]+`
Make sure your charset is UTF-8`);o=(o>>>8&255)*192+(o&255),n.put(o,13)}};var hr=Ae,ds={exports:{}};(function(n){var s={single_source_shortest_paths:function(o,r,l){var i={},d={};d[r]=0;var h=s.PriorityQueue.make();h.push(r,0);for(var u,b,p,$,j,N,k,y,G;!h.empty();){u=h.pop(),b=u.value,$=u.cost,j=o[b]||{};for(p in j)j.hasOwnProperty(p)&&(N=j[p],k=$+N,y=d[p],G=typeof d[p]>"u",(G||y>k)&&(d[p]=k,h.push(p,k),i[p]=b))}if(typeof l<"u"&&typeof d[l]>"u"){var _=["Could not find a path from ",r," to ",l,"."].join("");throw new Error(_)}return i},extract_shortest_path_from_predecessor_list:function(o,r){for(var l=[],i=r;i;)l.push(i),o[i],i=o[i];return l.reverse(),l},find_path:function(o,r,l){var i=s.single_source_shortest_paths(o,r,l);return s.extract_shortest_path_from_predecessor_list(i,l)},PriorityQueue:{make:function(o){var r=s.PriorityQueue,l={},i;o=o||{};for(i in r)r.hasOwnProperty(i)&&(l[i]=r[i]);return l.queue=[],l.sorter=o.sorter||r.default_sorter,l},default_sorter:function(o,r){return o.cost-r.cost},push:function(o,r){var l={value:o,cost:r};this.queue.push(l),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};n.exports=s})(ds);var gr=ds.exports;(function(n){const s=xe,o=ar,r=ir,l=cr,i=hr,d=le,h=ee,u=gr;function b(_){return unescape(encodeURIComponent(_)).length}function p(_,T,v){const S=[];let L;for(;(L=_.exec(v))!==null;)S.push({data:L[0],index:L.index,mode:T,length:L[0].length});return S}function $(_){const T=p(d.NUMERIC,s.NUMERIC,_),v=p(d.ALPHANUMERIC,s.ALPHANUMERIC,_);let S,L;return h.isKanjiModeEnabled()?(S=p(d.BYTE,s.BYTE,_),L=p(d.KANJI,s.KANJI,_)):(S=p(d.BYTE_KANJI,s.BYTE,_),L=[]),T.concat(v,S,L).sort(function(M,E){return M.index-E.index}).map(function(M){return{data:M.data,mode:M.mode,length:M.length}})}function j(_,T){switch(T){case s.NUMERIC:return o.getBitsLength(_);case s.ALPHANUMERIC:return r.getBitsLength(_);case s.KANJI:return i.getBitsLength(_);case s.BYTE:return l.getBitsLength(_)}}function N(_){return _.reduce(function(T,v){const S=T.length-1>=0?T[T.length-1]:null;return S&&S.mode===v.mode?(T[T.length-1].data+=v.data,T):(T.push(v),T)},[])}function k(_){const T=[];for(let v=0;v<_.length;v++){const S=_[v];switch(S.mode){case s.NUMERIC:T.push([S,{data:S.data,mode:s.ALPHANUMERIC,length:S.length},{data:S.data,mode:s.BYTE,length:S.length}]);break;case s.ALPHANUMERIC:T.push([S,{data:S.data,mode:s.BYTE,length:S.length}]);break;case s.KANJI:T.push([S,{data:S.data,mode:s.BYTE,length:b(S.data)}]);break;case s.BYTE:T.push([{data:S.data,mode:s.BYTE,length:b(S.data)}])}}return T}function y(_,T){const v={},S={start:{}};let L=["start"];for(let x=0;x<_.length;x++){const M=_[x],E=[];for(let P=0;P<M.length;P++){const B=M[P],oe=""+x+P;E.push(oe),v[oe]={node:B,lastCount:0},S[oe]={};for(let H=0;H<L.length;H++){const te=L[H];v[te]&&v[te].node.mode===B.mode?(S[te][oe]=j(v[te].lastCount+B.length,B.mode)-j(v[te].lastCount,B.mode),v[te].lastCount+=B.length):(v[te]&&(v[te].lastCount=B.length),S[te][oe]=j(B.length,B.mode)+4+s.getCharCountIndicator(B.mode,T))}}L=E}for(let x=0;x<L.length;x++)S[L[x]].end=0;return{map:S,table:v}}function G(_,T){let v;const S=s.getBestModeForData(_);if(v=s.from(T,S),v!==s.BYTE&&v.bit<S.bit)throw new Error('"'+_+'" cannot be encoded with mode '+s.toString(v)+`.
 Suggested mode is: `+s.toString(S));switch(v===s.KANJI&&!h.isKanjiModeEnabled()&&(v=s.BYTE),v){case s.NUMERIC:return new o(_);case s.ALPHANUMERIC:return new r(_);case s.KANJI:return new i(_);case s.BYTE:return new l(_)}}n.fromArray=function(T){return T.reduce(function(v,S){return typeof S=="string"?v.push(G(S,null)):S.data&&v.push(G(S.data,S.mode)),v},[])},n.fromString=function(T,v){const S=$(T,h.isKanjiModeEnabled()),L=k(S),x=y(L,v),M=u.find_path(x.map,"start","end"),E=[];for(let P=1;P<M.length-1;P++)E.push(x.table[M[P]].node);return n.fromArray(N(E))},n.rawSplit=function(T){return n.fromArray($(T,h.isKanjiModeEnabled()))}})(cs);const et=ee,ct=Ze,mr=Js,xr=Ys,fr=es,pr=ts,mt=ss,xt=Xe,yr=Zs,We=as,wr=is,br=xe,dt=cs;function Nr(n,s){const o=n.size,r=pr.getPositions(s);for(let l=0;l<r.length;l++){const i=r[l][0],d=r[l][1];for(let h=-1;h<=7;h++)if(!(i+h<=-1||o<=i+h))for(let u=-1;u<=7;u++)d+u<=-1||o<=d+u||(h>=0&&h<=6&&(u===0||u===6)||u>=0&&u<=6&&(h===0||h===6)||h>=2&&h<=4&&u>=2&&u<=4?n.set(i+h,d+u,!0,!0):n.set(i+h,d+u,!1,!0))}}function jr(n){const s=n.size;for(let o=8;o<s-8;o++){const r=o%2===0;n.set(o,6,r,!0),n.set(6,o,r,!0)}}function Cr(n,s){const o=fr.getPositions(s);for(let r=0;r<o.length;r++){const l=o[r][0],i=o[r][1];for(let d=-2;d<=2;d++)for(let h=-2;h<=2;h++)d===-2||d===2||h===-2||h===2||d===0&&h===0?n.set(l+d,i+h,!0,!0):n.set(l+d,i+h,!1,!0)}}function vr(n,s){const o=n.size,r=We.getEncodedBits(s);let l,i,d;for(let h=0;h<18;h++)l=Math.floor(h/3),i=h%3+o-8-3,d=(r>>h&1)===1,n.set(l,i,d,!0),n.set(i,l,d,!0)}function ut(n,s,o){const r=n.size,l=wr.getEncodedBits(s,o);let i,d;for(i=0;i<15;i++)d=(l>>i&1)===1,i<6?n.set(i,8,d,!0):i<8?n.set(i+1,8,d,!0):n.set(r-15+i,8,d,!0),i<8?n.set(8,r-i-1,d,!0):i<9?n.set(8,15-i-1+1,d,!0):n.set(8,15-i-1,d,!0);n.set(r-8,8,1,!0)}function _r(n,s){const o=n.size;let r=-1,l=o-1,i=7,d=0;for(let h=o-1;h>0;h-=2)for(h===6&&h--;;){for(let u=0;u<2;u++)if(!n.isReserved(l,h-u)){let b=!1;d<s.length&&(b=(s[d]>>>i&1)===1),n.set(l,h-u,b),i--,i===-1&&(d++,i=7)}if(l+=r,l<0||o<=l){l-=r,r=-r;break}}}function Sr(n,s,o){const r=new mr;o.forEach(function(u){r.put(u.mode.bit,4),r.put(u.getLength(),br.getCharCountIndicator(u.mode,n)),u.write(r)});const l=et.getSymbolTotalCodewords(n),i=xt.getTotalCodewordsCount(n,s),d=(l-i)*8;for(r.getLengthInBits()+4<=d&&r.put(0,4);r.getLengthInBits()%8!==0;)r.putBit(0);const h=(d-r.getLengthInBits())/8;for(let u=0;u<h;u++)r.put(u%2?17:236,8);return Er(r,n,s)}function Er(n,s,o){const r=et.getSymbolTotalCodewords(s),l=xt.getTotalCodewordsCount(s,o),i=r-l,d=xt.getBlocksCount(s,o),h=r%d,u=d-h,b=Math.floor(r/d),p=Math.floor(i/d),$=p+1,j=b-p,N=new yr(j);let k=0;const y=new Array(d),G=new Array(d);let _=0;const T=new Uint8Array(n.buffer);for(let M=0;M<d;M++){const E=M<u?p:$;y[M]=T.slice(k,k+E),G[M]=N.encode(y[M]),k+=E,_=Math.max(_,E)}const v=new Uint8Array(r);let S=0,L,x;for(L=0;L<_;L++)for(x=0;x<d;x++)L<y[x].length&&(v[S++]=y[x][L]);for(L=0;L<j;L++)for(x=0;x<d;x++)v[S++]=G[x][L];return v}function Ar(n,s,o,r){let l;if(Array.isArray(n))l=dt.fromArray(n);else if(typeof n=="string"){let b=s;if(!b){const p=dt.rawSplit(n);b=We.getBestVersionForData(p,o)}l=dt.fromString(n,b||40)}else throw new Error("Invalid data");const i=We.getBestVersionForData(l,o);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!s)s=i;else if(s<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const d=Sr(s,o,l),h=et.getSymbolSize(s),u=new xr(h);return Nr(u,s),jr(u),Cr(u,s),ut(u,o,0),s>=7&&vr(u,s),_r(u,d),isNaN(r)&&(r=mt.getBestMask(u,ut.bind(null,u,o))),mt.applyMask(r,u),ut(u,o,r),{modules:u,version:s,errorCorrectionLevel:o,maskPattern:r,segments:l}}Xt.create=function(s,o){if(typeof s>"u"||s==="")throw new Error("No input text");let r=ct.M,l,i;return typeof o<"u"&&(r=ct.from(o.errorCorrectionLevel,ct.M),l=We.from(o.version),i=mt.from(o.maskPattern),o.toSJISFunc&&et.setToSJISFunction(o.toSJISFunc)),Ar(s,l,r,i)};var us={},bt={};(function(n){function s(o){if(typeof o=="number"&&(o=o.toString()),typeof o!="string")throw new Error("Color should be defined as hex string");let r=o.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+o);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(i){return[i,i]}))),r.length===6&&r.push("F","F");const l=parseInt(r.join(""),16);return{r:l>>24&255,g:l>>16&255,b:l>>8&255,a:l&255,hex:"#"+r.slice(0,6).join("")}}n.getOptions=function(r){r||(r={}),r.color||(r.color={});const l=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,i=r.width&&r.width>=21?r.width:void 0,d=r.scale||4;return{width:i,scale:i?4:d,margin:l,color:{dark:s(r.color.dark||"#000000ff"),light:s(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},n.getScale=function(r,l){return l.width&&l.width>=r+l.margin*2?l.width/(r+l.margin*2):l.scale},n.getImageWidth=function(r,l){const i=n.getScale(r,l);return Math.floor((r+l.margin*2)*i)},n.qrToImageData=function(r,l,i){const d=l.modules.size,h=l.modules.data,u=n.getScale(d,i),b=Math.floor((d+i.margin*2)*u),p=i.margin*u,$=[i.color.light,i.color.dark];for(let j=0;j<b;j++)for(let N=0;N<b;N++){let k=(j*b+N)*4,y=i.color.light;if(j>=p&&N>=p&&j<b-p&&N<b-p){const G=Math.floor((j-p)/u),_=Math.floor((N-p)/u);y=$[h[G*d+_]?1:0]}r[k++]=y.r,r[k++]=y.g,r[k++]=y.b,r[k]=y.a}}})(bt);(function(n){const s=bt;function o(l,i,d){l.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=d,i.width=d,i.style.height=d+"px",i.style.width=d+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}n.render=function(i,d,h){let u=h,b=d;typeof u>"u"&&(!d||!d.getContext)&&(u=d,d=void 0),d||(b=r()),u=s.getOptions(u);const p=s.getImageWidth(i.modules.size,u),$=b.getContext("2d"),j=$.createImageData(p,p);return s.qrToImageData(j.data,i,u),o($,b,p),$.putImageData(j,0,0),b},n.renderToDataURL=function(i,d,h){let u=h;typeof u>"u"&&(!d||!d.getContext)&&(u=d,d=void 0),u||(u={});const b=n.render(i,d,u),p=u.type||"image/png",$=u.rendererOpts||{};return b.toDataURL(p,$.quality)}})(us);var hs={};const kr=bt;function Wt(n,s){const o=n.a/255,r=s+'="'+n.hex+'"';return o<1?r+" "+s+'-opacity="'+o.toFixed(2).slice(1)+'"':r}function ht(n,s,o){let r=n+s;return typeof o<"u"&&(r+=" "+o),r}function Tr(n,s,o){let r="",l=0,i=!1,d=0;for(let h=0;h<n.length;h++){const u=Math.floor(h%s),b=Math.floor(h/s);!u&&!i&&(i=!0),n[h]?(d++,h>0&&u>0&&n[h-1]||(r+=i?ht("M",u+o,.5+b+o):ht("m",l,0),l=0,i=!1),u+1<s&&n[h+1]||(r+=ht("h",d),d=0)):l++}return r}hs.render=function(s,o,r){const l=kr.getOptions(o),i=s.modules.size,d=s.modules.data,h=i+l.margin*2,u=l.color.light.a?"<path "+Wt(l.color.light,"fill")+' d="M0 0h'+h+"v"+h+'H0z"/>':"",b="<path "+Wt(l.color.dark,"stroke")+' d="'+Tr(d,i,l.margin)+'"/>',p='viewBox="0 0 '+h+" "+h+'"',j='<svg xmlns="http://www.w3.org/2000/svg" '+(l.width?'width="'+l.width+'" height="'+l.width+'" ':"")+p+' shape-rendering="crispEdges">'+u+b+`</svg>
`;return typeof r=="function"&&r(null,j),j};const Mr=Hs,ft=Xt,gs=us,Pr=hs;function Nt(n,s,o,r,l){const i=[].slice.call(arguments,1),d=i.length,h=typeof i[d-1]=="function";if(!h&&!Mr())throw new Error("Callback required as last argument");if(h){if(d<2)throw new Error("Too few arguments provided");d===2?(l=o,o=s,s=r=void 0):d===3&&(s.getContext&&typeof l>"u"?(l=r,r=void 0):(l=r,r=o,o=s,s=void 0))}else{if(d<1)throw new Error("Too few arguments provided");return d===1?(o=s,s=r=void 0):d===2&&!s.getContext&&(r=o,o=s,s=void 0),new Promise(function(u,b){try{const p=ft.create(o,r);u(n(p,s,r))}catch(p){b(p)}})}try{const u=ft.create(o,r);l(null,n(u,s,r))}catch(u){l(u)}}we.create=ft.create;we.toCanvas=Nt.bind(null,gs.render);we.toDataURL=Nt.bind(null,gs.renderToDataURL);we.toString=Nt.bind(null,function(n,s,o){return Pr.render(n,o)});const Rr=({url:n,title:s="QR Code",description:o="Scan this QR code to access the form",size:r=200,showControls:l=!0})=>{const[i,d]=D.useState(null),[h,u]=D.useState(!1),[b,p]=D.useState(null),[$,j]=D.useState(!1),[N,k]=D.useState(r),[y,G]=D.useState(n||"");D.useRef(null),D.useEffect(()=>{y!=null&&y.trim()&&_(y,N)},[y,N]);const _=async(x,M=200)=>{var E;try{if(u(!0),p(null),!(x!=null&&x.trim()))throw new Error("URL is required to generate QR code");let P=x==null?void 0:x.trim();!(P!=null&&P.startsWith("http://"))&&!(P!=null&&P.startsWith("https://"))&&(P!=null&&P.startsWith("/")?P=`${(E=window==null?void 0:window.location)==null?void 0:E.origin}${P}`:P=`https://${P}`);const B=await(we==null?void 0:we.toDataURL(P,{width:M,height:M,margin:2,color:{dark:"#000000",light:"#FFFFFF"},errorCorrectionLevel:"M"}));d(B)}catch(P){console.error("Error generating QR code:",P),p((P==null?void 0:P.message)||"Failed to generate QR code")}finally{u(!1)}},T=()=>{var x,M;if(i)try{const E=document==null?void 0:document.createElement("a");E.download=`${s==null?void 0:s.replace(/[^a-zA-Z0-9]/g,"_")}_QRCode.png`,E.href=i,(x=document==null?void 0:document.body)==null||x.appendChild(E),E==null||E.click(),(M=document==null?void 0:document.body)==null||M.removeChild(E)}catch(E){console.error("Error downloading QR code:",E),p("Failed to download QR code")}},v=async()=>{var x,M,E;try{if(navigator!=null&&navigator.clipboard&&i){const P=await fetch(i),B=await(P==null?void 0:P.blob());await((x=navigator==null?void 0:navigator.clipboard)==null?void 0:x.write([new ClipboardItem({"image/png":B})])),j(!0),setTimeout(()=>j(!1),2e3)}else await((M=navigator==null?void 0:navigator.clipboard)==null?void 0:M.writeText(y)),j(!0),setTimeout(()=>j(!1),2e3)}catch(P){console.error("Error copying to clipboard:",P);try{await((E=navigator==null?void 0:navigator.clipboard)==null?void 0:E.writeText(y)),j(!0),setTimeout(()=>j(!1),2e3)}catch{p("Failed to copy to clipboard")}}},S=async()=>{try{if(navigator!=null&&navigator.share&&i){const x=await fetch(i),M=await(x==null?void 0:x.blob()),E=new File([M],`${s}_QRCode.png`,{type:"image/png"});await(navigator==null?void 0:navigator.share({title:s,text:o,url:y,files:[E]}))}else await v()}catch(x){console.error("Error sharing QR code:",x),(x==null?void 0:x.name)!=="AbortError"&&p("Failed to share QR code")}},L=()=>{G(n||""),k(r),p(null),j(!1)};return e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6",children:[e.jsxs("div",{className:"flex items-center mb-4",children:[e.jsx(Je,{className:"w-5 h-5 text-blue-600 mr-2"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:s})]}),o&&e.jsx("p",{className:"text-gray-600 text-sm mb-6",children:o}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3 mb-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Zt,{className:"w-4 h-4 text-red-600 mr-2"}),e.jsx("p",{className:"text-red-800 text-sm",children:b})]})}),l&&e.jsxs("div",{className:"mb-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"URL to Generate QR Code"}),e.jsx("input",{type:"url",value:y,onChange:x=>{var M;return G((M=x==null?void 0:x.target)==null?void 0:M.value)},placeholder:"Enter URL (e.g., https://yoursite.com/guest-claims-form)",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["QR Code Size: ",N,"px"]}),e.jsx("input",{type:"range",min:"100",max:"400",step:"25",value:N,onChange:x=>{var M;return k(parseInt((M=x==null?void 0:x.target)==null?void 0:M.value))},className:"w-full"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Y,{onClick:()=>_(y,N),disabled:h||!(y!=null&&y.trim()),variant:"primary",size:"md",className:"","aria-label":"Generate QR Code",children:h?"Generating...":"Generate QR Code"}),e.jsx(Y,{onClick:L,variant:"secondary",size:"md",className:"","aria-label":"Reset to default values",children:"Reset"})]})]}),e.jsxs("div",{className:"flex flex-col items-center mb-6",children:[h&&e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Generating QR Code..."})]}),i&&!h&&e.jsx("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 shadow-sm",children:e.jsx("img",{src:i,alt:`QR Code for ${s}`,className:"block",style:{width:N,height:N}})}),!i&&!h&&(y==null?void 0:y.trim())&&e.jsx("div",{className:"flex items-center justify-center p-8 border-2 border-dashed border-gray-300 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Je,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:'Click "Generate QR Code" to create QR code'})]})}),!(y!=null&&y.trim())&&l&&e.jsx("div",{className:"flex items-center justify-center p-8 border-2 border-dashed border-gray-300 rounded-lg",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Je,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-gray-500",children:"Enter a URL to generate QR code"})]})})]}),i&&e.jsxs("div",{className:"flex flex-wrap gap-2 justify-center",children:[e.jsxs(Y,{onClick:T,variant:"primary",size:"md",className:"","aria-label":"Download QR Code as PNG",children:[e.jsx(Bs,{className:"w-4 h-4 mr-1"}),"Download PNG"]}),e.jsxs(Y,{onClick:v,variant:"secondary",size:"md",className:"","aria-label":$?"QR Code copied":"Copy QR Code to clipboard",children:[$?e.jsx(Ds,{className:"w-4 h-4 mr-1"}):e.jsx(Ls,{className:"w-4 h-4 mr-1"}),$?"Copied!":"Copy"]}),(navigator==null?void 0:navigator.share)&&e.jsxs(Y,{onClick:S,variant:"secondary",size:"md",className:"","aria-label":"Share QR Code",children:[e.jsx(Is,{className:"w-4 h-4 mr-1"}),"Share"]})]}),y&&e.jsxs("div",{className:"mt-4 p-3 bg-gray-50 border border-gray-200 rounded-md",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Target URL:"}),e.jsx("p",{className:"text-sm font-mono text-gray-800 break-all",children:y})]})]})},zr=()=>{var At,kt,Tt,Mt,Pt;const{userProfile:n,user:s,loading:o}=Us(),{orgId:r}=Os(),{logBusinessAction:l,logError:i}=Gs(),[d,h]=D.useState(!0),[u,b]=D.useState("userAccounts"),[p,$]=D.useState(null),[j,N]=D.useState(!0),[k,y]=D.useState(""),[G,_]=D.useState(""),[T,v]=D.useState(""),[S,L]=D.useState(""),[x,M]=D.useState({authUser:null,userProfile:null,profileLoadError:null,showDebug:!1}),[E,P]=D.useState([]),[B,oe]=D.useState([]),[H,te]=D.useState([]),[W,jt]=D.useState([]),[Z,Ct]=D.useState([]),[ce,X]=D.useState(!1),[ke,vt]=D.useState(null),[ms,Oe]=D.useState(!1),[re,xs]=D.useState(""),[I,_t]=D.useState(null),[f,fe]=D.useState({full_name:"",email:"",password:"",role:"manager",department:"",phone:"",org_id:null}),[q,Te]=D.useState({full_name:"",phone:"",email:"",department:"",org_id:null}),[A,pe]=D.useState({name:"",contact_person:"",phone:"",email:"",specialty:"",rating:""}),[w,ie]=D.useState({name:"",brand:"",category:"",cost:"",unit_price:"",part_number:"",description:"",op_code:""}),[Q,Ge]=D.useState({name:"",message_template:"",template_type:"job_status"}),tt=[{id:"userAccounts",label:"User Accounts",icon:qs},{id:"staffRecords",label:"Staff Records",icon:Vs},{id:"vendors",label:"Vendors",icon:ye},{id:"products",label:"Aftermarket Products",icon:zs},{id:"smsTemplates",label:"SMS Templates",icon:Qs},{id:"qrCodes",label:"QR Code Generator",icon:Je}],st=[{value:"admin",label:"Admin"},{value:"manager",label:"Manager"},{value:"staff",label:"Staff"},{value:"vendor",label:"Vendor"}],rt=[{value:"Delivery Coordinator",label:"Delivery Coordinator"},{value:"Finance Manager",label:"Finance Manager"},{value:"Sales Consultants",label:"Sales Consultants"},{value:"Managers",label:"Managers"}],nt=[{value:"Sales Consultants",label:"Sales Consultants"},{value:"Finance Manager",label:"Finance Manager"},{value:"Delivery Coordinator",label:"Delivery Coordinator"}],at=[{value:"job_status",label:"Job Status"},{value:"overdue_alert",label:"Overdue Alert"},{value:"customer_notification",label:"Customer Notification"},{value:"vendor_assignment",label:"Vendor Assignment"},{value:"completion_notice",label:"Completion Notice"}];D.useEffect(()=>{o||(async()=>{var g,a,c;try{if(console.log("Admin panel initializing...",{authLoading:o,user:!!s,userProfile:!!n}),!R){$("Database connection unavailable. Please refresh the page."),h(!1);return}const{error:m}=await((c=(a=(g=R)==null?void 0:g.from("user_profiles"))==null?void 0:a.select("id"))==null?void 0:c.limit(1));if(m){console.error("Database connection failed:",m),$("Unable to connect to database. Please check your Supabase configuration."),h(!1);return}await St(),h(!1)}catch(m){console.error("Admin initialization failed:",m),$("Failed to initialize admin panel: "+(m==null?void 0:m.message)),h(!1)}})()},[o]);const fs=async()=>{var t,g,a,c,m,U,z,F,de,se,ne,ue,he,Be,De;console.log("=== ADMIN ACCESS DEBUG ===");try{const{data:{session:V},error:je}=await((g=(t=R)==null?void 0:t.auth)==null?void 0:g.getSession());if(console.log("Current session:",{hasSession:!!V,sessionError:je,userId:(a=V==null?void 0:V.user)==null?void 0:a.id,userEmail:(c=V==null?void 0:V.user)==null?void 0:c.email}),V!=null&&V.user){console.log("Auth user:",{id:(m=V==null?void 0:V.user)==null?void 0:m.id,email:(U=V==null?void 0:V.user)==null?void 0:U.email,role:(z=V==null?void 0:V.user)==null?void 0:z.role}),console.log("Attempting to fetch user profile...");const{data:ve,error:Ie}=await((ue=(ne=(de=(F=R)==null?void 0:F.from("user_profiles"))==null?void 0:de.select("*"))==null?void 0:ne.eq("id",(se=V==null?void 0:V.user)==null?void 0:se.id))==null?void 0:ue.single());console.log("Direct profile fetch result:",{profile:ve,profileError:Ie,hasProfile:!!ve}),M({authUser:V==null?void 0:V.user,userProfile:ve,profileLoadError:Ie,showDebug:!0})}else console.log("No authenticated user found"),M({authUser:null,userProfile:null,profileLoadError:{message:"No authenticated user"},showDebug:!0});console.log("Testing database access...");const{data:Ce,error:Le}=await((De=(Be=(he=R)==null?void 0:he.from("user_profiles"))==null?void 0:Be.select("id, full_name, role"))==null?void 0:De.limit(5));console.log("Database access test:",{canAccess:!Le,recordCount:(Ce==null?void 0:Ce.length)||0,error:Le})}catch(V){console.error("Debug error:",V),M(je=>({...je,profileLoadError:V,showDebug:!0}))}},St=async()=>{console.log("Loading admin data...");try{const t=await Promise.allSettled([be(),Ne(),Me(),Pe(),lt()]);t==null||t.forEach((g,a)=>{const c=["User Accounts","Staff Records","Vendors","Products","SMS Templates"];(g==null?void 0:g.status)==="rejected"?console.error(`Failed to load ${c==null?void 0:c[a]}:`,g==null?void 0:g.reason):console.log(`Successfully loaded ${c==null?void 0:c[a]}`)})}catch(t){console.error("Error loading admin data:",t),$("Failed to load some admin data. Please try refreshing the page.")}},be=async()=>{var t,g,a;try{console.log("Loading user accounts...");let c=(a=(g=(t=R)==null?void 0:t.from("user_profiles"))==null?void 0:g.select("*",{count:"exact"}))==null?void 0:a.in("role",["admin","manager"]);j&&r&&(c=c==null?void 0:c.eq("org_id",r)),c=c==null?void 0:c.order("created_at",{ascending:!1});const{data:m,error:U,count:z}=await c;if(U)throw console.error("User accounts query error:",U),U;console.log(`User accounts query result: ${(m==null?void 0:m.length)||0} records`),P(m||[])}catch(c){console.error("Error loading user accounts:",c)}},Ne=async()=>{var t,g,a;try{console.log("Loading staff records...");let c=(a=(g=(t=R)==null?void 0:t.from("user_profiles"))==null?void 0:g.select("*",{count:"exact"}))==null?void 0:a.eq("role","staff");j&&r&&(c=c==null?void 0:c.eq("org_id",r)),c=c==null?void 0:c.order("created_at",{ascending:!1});const{data:m,error:U}=await c;if(U)throw console.error("Staff records query error:",U),U;console.log(`Staff records: ${m==null?void 0:m.length} staff members found`),oe(m||[])}catch(c){console.error("Error loading staff records:",c)}},Et=async t=>{var g,a,c;if(!r)return alert("No organization detected for current user");try{X(!0);const{error:m}=await((c=(a=(g=R)==null?void 0:g.from("user_profiles"))==null?void 0:a.update({org_id:r,is_active:!0}))==null?void 0:c.eq("id",t));if(m)throw m;await Promise.all([be(),Ne()])}catch(m){console.error("attachProfileToMyOrg error:",m),alert("Failed to attach to org: "+((m==null?void 0:m.message)||"Unknown error"))}finally{X(!1)}},ps=async()=>{var t,g,a,c;if(y(""),!r){y("No organization detected for current user.");return}try{X(!0);const{error:m}=await((c=(a=(g=(t=R)==null?void 0:t.from("user_profiles"))==null?void 0:g.update({org_id:r,is_active:!0}))==null?void 0:a.is("org_id",null))==null?void 0:c.eq("role","staff"));if(m)throw m;y("Assigned org to active staff without org."),await Ne();try{await(l==null?void 0:l("assign_org_staff","system",null,"Assigned org to staff without org",{orgId:r}))}catch{}}catch(m){console.error("assignOrgToActiveStaff error:",m),y((m==null?void 0:m.message)||"Failed to assign org to staff");try{await(i==null?void 0:i(m,{where:"assignOrgToActiveStaff",orgId:r}))}catch{}}finally{X(!1)}},ys=async()=>{var t,g,a,c;if(_(""),!r){_("No organization detected for current user.");return}try{X(!0);const{error:m}=await((c=(a=(g=(t=R)==null?void 0:t.from("user_profiles"))==null?void 0:g.update({org_id:r,is_active:!0}))==null?void 0:a.is("org_id",null))==null?void 0:c.in("role",["admin","manager"]));if(m)throw m;_("Assigned org to admin/manager accounts without org."),await be()}catch(m){console.error("assignOrgToAccounts error:",m),_((m==null?void 0:m.message)||"Failed to assign org to accounts")}finally{X(!1)}};D.useEffect(()=>{Ne(),be(),Me(),Pe()},[j,r]);const Me=async()=>{var t,g;try{console.log("Loading vendors...");let a=(g=(t=R)==null?void 0:t.from("vendors"))==null?void 0:g.select("*",{count:"exact"});j&&r&&(a=a==null?void 0:a.eq("org_id",r)),a=a==null?void 0:a.order("created_at",{ascending:!1});const{data:c,error:m,count:U}=await a;if(m)throw console.error("Vendors query error:",m),m;console.log(`Vendors query result: ${(c==null?void 0:c.length)||0} records`),te(c||[])}catch(a){console.error("Error loading vendors:",a)}},Pe=async()=>{var t,g;try{console.log("Loading products...");let a=(g=(t=R)==null?void 0:t.from("products"))==null?void 0:g.select("*, vendors(name)",{count:"exact"});j&&r&&(a=a==null?void 0:a.eq("org_id",r)),a=a==null?void 0:a.order("created_at",{ascending:!1});const{data:c,error:m,count:U}=await a;if(m)throw console.error("Products query error:",m),m;console.log(`Products query result: ${(c==null?void 0:c.length)||0} records`),jt(c||[])}catch(a){console.error("Error loading products:",a)}},ws=async()=>{var t,g,a;if(v(""),!r){v("No organization detected for current user.");return}try{X(!0);const{error:c}=await((a=(g=(t=R)==null?void 0:t.from("vendors"))==null?void 0:g.update({org_id:r}))==null?void 0:a.is("org_id",null));if(c)throw c;v("Assigned org to vendors without org."),await Me();try{await(l==null?void 0:l("assign_org_vendors","system",null,"Assigned org to vendors without org",{orgId:r}))}catch{}}catch(c){console.error("assignOrgToVendors error:",c),v((c==null?void 0:c.message)||"Failed to assign org to vendors");try{await(i==null?void 0:i(c,{where:"assignOrgToVendors",orgId:r}))}catch{}}finally{X(!1)}},bs=async()=>{var t,g,a;if(L(""),!r){L("No organization detected for current user.");return}try{X(!0);const{error:c}=await((a=(g=(t=R)==null?void 0:t.from("products"))==null?void 0:g.update({org_id:r}))==null?void 0:a.is("org_id",null));if(c)throw c;L("Assigned org to products without org."),await Pe();try{await(l==null?void 0:l("assign_org_products","system",null,"Assigned org to products without org",{orgId:r}))}catch{}}catch(c){console.error("assignOrgToProducts error:",c),L((c==null?void 0:c.message)||"Failed to assign org to products");try{await(i==null?void 0:i(c,{where:"assignOrgToProducts",orgId:r}))}catch{}}finally{X(!1)}},lt=async()=>{var t,g,a;try{console.log("Loading SMS templates...");const{data:c,error:m,count:U}=await((a=(g=(t=R)==null?void 0:t.from("sms_templates"))==null?void 0:g.select("*",{count:"exact"}))==null?void 0:a.order("created_at",{ascending:!1}));if(m)throw console.error("SMS templates query error:",m),m;console.log(`SMS templates query result: ${(c==null?void 0:c.length)||0} records`),Ct(c||[])}catch(c){console.error("Error loading SMS templates:",c)}},ae=(t,g=null)=>{xs(t),_t(g),Oe(!0),t==="userAccount"?fe(g||{full_name:"",email:"",password:"",role:"manager",department:"",phone:""}):t==="staff"?Te(g||{full_name:"",phone:"",email:"",department:""}):t==="vendor"?pe(g||{name:"",contact_person:"",phone:"",email:"",specialty:"",rating:""}):t==="product"?ie(g||{name:"",brand:"",category:"",cost:"",unit_price:"",part_number:"",description:"",op_code:""}):t==="template"&&Ge(g||{name:"",message_template:"",template_type:"job_status"})},Ns=async t=>{t==null||t.preventDefault(),X(!0);try{re==="userAccount"?await js():re==="staff"?await Cs():re==="vendor"?await vs():re==="product"?await _s():re==="template"&&await Ss(),Oe(!1),_t(null)}catch(g){console.error("Error submitting form:",g),alert("Error: "+(g==null?void 0:g.message))}finally{X(!1)}},js=async()=>{var t,g,a,c,m,U,z,F,de;if(I){const se={full_name:f==null?void 0:f.full_name,email:f==null?void 0:f.email,role:f==null?void 0:f.role,department:f==null?void 0:f.department,phone:f==null?void 0:f.phone};!(I!=null&&I.org_id)&&r&&(se.org_id=r);const{error:ne}=await((a=(g=(t=R)==null?void 0:t.from("user_profiles"))==null?void 0:g.update(se))==null?void 0:a.eq("id",I==null?void 0:I.id));if(ne)throw ne}else{if(!(f!=null&&f.password))throw new Error("Password is required for new users");const{data:se,error:ne}=await((m=(c=R)==null?void 0:c.auth)==null?void 0:m.signUp({email:f==null?void 0:f.email,password:f==null?void 0:f.password,options:{data:{full_name:f==null?void 0:f.full_name,role:f==null?void 0:f.role,department:f==null?void 0:f.department,phone:f==null?void 0:f.phone}}}));if(ne)throw ne;const ue=(U=se==null?void 0:se.user)==null?void 0:U.id;if(ue){const{error:he}=await((de=(F=(z=R)==null?void 0:z.from("user_profiles"))==null?void 0:F.update({full_name:f==null?void 0:f.full_name,role:f==null?void 0:f.role,department:f==null?void 0:f.department,phone:f==null?void 0:f.phone,org_id:r||null,is_active:!0}))==null?void 0:de.eq("id",ue));if(he)throw he}}await be()},Cs=async()=>{var g,a,c,m,U;const t={full_name:q==null?void 0:q.full_name,phone:(q==null?void 0:q.phone)||null,email:(q==null?void 0:q.email)||null,department:q==null?void 0:q.department,role:"staff",is_active:!0,vendor_id:null,org_id:(q==null?void 0:q.org_id)||r||null};if(I){!(I!=null&&I.org_id)&&r&&(t.org_id=r);const{error:z}=await((c=(a=(g=R)==null?void 0:g.from("user_profiles"))==null?void 0:a.update(t))==null?void 0:c.eq("id",I==null?void 0:I.id));if(z)throw z}else{const{error:z}=await((U=(m=R)==null?void 0:m.from("user_profiles"))==null?void 0:U.insert([t]));if(z)throw z}await Ne()},vs=async()=>{var g,a,c,m,U;const t={name:A==null?void 0:A.name,contact_person:A==null?void 0:A.contact_person,phone:A==null?void 0:A.phone,email:A==null?void 0:A.email,specialty:A==null?void 0:A.specialty,rating:A!=null&&A.rating?parseFloat(A==null?void 0:A.rating):null};if(I){const{error:z}=await((c=(a=(g=R)==null?void 0:g.from("vendors"))==null?void 0:a.update(t))==null?void 0:c.eq("id",I==null?void 0:I.id));if(z)throw z}else{const{error:z}=await((U=(m=R)==null?void 0:m.from("vendors"))==null?void 0:U.insert([t]));if(z)throw z}await Me()},_s=async()=>{var g,a,c,m,U;const t={name:w==null?void 0:w.name,brand:w==null?void 0:w.brand,category:w==null?void 0:w.category,cost:w!=null&&w.cost?parseFloat(w==null?void 0:w.cost):0,unit_price:w!=null&&w.unit_price?parseFloat(w==null?void 0:w.unit_price):0,part_number:w==null?void 0:w.part_number,description:w==null?void 0:w.description,op_code:(w==null?void 0:w.op_code)||null};if(I){const{error:z}=await((c=(a=(g=R)==null?void 0:g.from("products"))==null?void 0:a.update(t))==null?void 0:c.eq("id",I==null?void 0:I.id));if(z)throw z}else{const{error:z}=await((U=(m=R)==null?void 0:m.from("products"))==null?void 0:U.insert([t]));if(z)throw z}await Pe()},Ss=async()=>{var a,c,m,U,z;let t=Q==null?void 0:Q.message_template;if(!(t!=null&&t.startsWith("Stock #"))&&!(t!=null&&t.startsWith("{{stock"))&&(t="Stock #{{stock_number}}: "+t),(t==null?void 0:t.length)>160)throw new Error("SMS template must be under 160 characters");const g={name:Q==null?void 0:Q.name,message_template:t,template_type:Q==null?void 0:Q.template_type};if(I){const{error:F}=await((m=(c=(a=R)==null?void 0:a.from("sms_templates"))==null?void 0:c.update(g))==null?void 0:m.eq("id",I==null?void 0:I.id));if(F)throw F}else{const{error:F}=await((z=(U=R)==null?void 0:U.from("sms_templates"))==null?void 0:z.insert([g]));if(F)throw F}await lt()},Re=async(t,g,a=null)=>{var c,m,U,z,F,de,se,ne,ue,he,Be,De,V,je,Ce,Le,ve,Ie,Rt,Bt,Dt,Lt,It,Ut,$t,qt,Vt,zt,Qt,Ot,Gt,Ht,Kt;if(confirm("Are you sure you want to delete this item?")){vt(g),X(!0);try{if(console.log(`Deleting from ${t} with id: ${g}`),t==="user_profiles"){console.log("Cleaning up foreign key dependencies...");const C=[(U=(m=(c=R)==null?void 0:c.from("jobs"))==null?void 0:m.update({assigned_to:null,created_by:null,delivery_coordinator_id:null}))==null?void 0:U.or(`assigned_to.eq.${g},created_by.eq.${g},delivery_coordinator_id.eq.${g}`)];C==null||C.push((de=(F=(z=R)==null?void 0:z.from("transactions"))==null?void 0:F.update({processed_by:null}))==null?void 0:de.eq("processed_by",g)),C==null||C.push((ue=(ne=(se=R)==null?void 0:se.from("vehicles"))==null?void 0:ne.update({created_by:null}))==null?void 0:ue.eq("created_by",g)),C==null||C.push((De=(Be=(he=R)==null?void 0:he.from("vendors"))==null?void 0:Be.update({created_by:null}))==null?void 0:De.eq("created_by",g)),C==null||C.push((Ce=(je=(V=R)==null?void 0:V.from("products"))==null?void 0:je.update({created_by:null}))==null?void 0:Ce.eq("created_by",g)),C==null||C.push((Ie=(ve=(Le=R)==null?void 0:Le.from("sms_templates"))==null?void 0:ve.update({created_by:null}))==null?void 0:Ie.eq("created_by",g)),C==null||C.push((Dt=(Bt=(Rt=R)==null?void 0:Rt.from("filter_presets"))==null?void 0:Bt.delete())==null?void 0:Dt.eq("user_id",g)),C==null||C.push((Ut=(It=(Lt=R)==null?void 0:Lt.from("notification_preferences"))==null?void 0:It.delete())==null?void 0:Ut.eq("user_id",g)),C==null||C.push((Vt=(qt=($t=R)==null?void 0:$t.from("activity_history"))==null?void 0:qt.delete())==null?void 0:Vt.eq("performed_by",g)),C==null||C.push((Ot=(Qt=(zt=R)==null?void 0:zt.from("communications"))==null?void 0:Qt.delete())==null?void 0:Ot.eq("sent_by",g)),await Promise.allSettled(C),console.log("Foreign key cleanup completed")}const{error:ge}=await((Kt=(Ht=(Gt=R)==null?void 0:Gt.from(t))==null?void 0:Ht.delete())==null?void 0:Kt.eq("id",g));if(ge)throw console.error("Delete operation failed:",ge),ge;console.log("Delete operation successful"),t==="user_profiles"?(a==="userAccount"?P(C=>{const O=C==null?void 0:C.filter(J=>(J==null?void 0:J.id)!==g);return console.log(`User accounts updated: ${O==null?void 0:O.length} remaining`),O||[]}):oe(C=>{const O=C==null?void 0:C.filter(J=>(J==null?void 0:J.id)!==g);return console.log(`Staff records updated: ${O==null?void 0:O.length} remaining`),O||[]}),setTimeout(async()=>{try{await Promise.all([be(),Ne()]),console.log("Data reloaded successfully after deletion")}catch(C){console.error("Error refreshing data after deletion:",C)}},500)):t==="vendors"?(te(C=>{const O=C==null?void 0:C.filter(J=>(J==null?void 0:J.id)!==g);return console.log(`Vendors updated: ${O==null?void 0:O.length} remaining`),O||[]}),setTimeout(async()=>{try{await Me(),console.log("Vendors reloaded successfully")}catch(C){console.error("Error refreshing vendors:",C)}},500)):t==="products"?(jt(C=>{const O=C==null?void 0:C.filter(J=>(J==null?void 0:J.id)!==g);return console.log(`Products updated: ${O==null?void 0:O.length} remaining`),O||[]}),setTimeout(async()=>{try{await Pe(),console.log("Products reloaded successfully")}catch(C){console.error("Error refreshing products:",C)}},500)):t==="sms_templates"&&(Ct(C=>{const O=C==null?void 0:C.filter(J=>(J==null?void 0:J.id)!==g);return console.log(`SMS templates updated: ${O==null?void 0:O.length} remaining`),O||[]}),setTimeout(async()=>{try{await lt(),console.log("SMS templates reloaded successfully")}catch(C){console.error("Error refreshing SMS templates:",C)}},500)),console.log(`Successfully deleted item from ${t}`)}catch(ge){console.error("Error deleting item:",ge),alert("Error deleting item: "+((ge==null?void 0:ge.message)||"Unknown error")),setTimeout(async()=>{try{await St(),console.log("All data reloaded after error")}catch(C){console.error("Error refreshing all data after deletion error:",C)}},1e3)}finally{X(!1),vt(null)}}},Es=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["User Accounts (",(E==null?void 0:E.length)||0,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-blue-600 appearance-auto",checked:j,onChange:t=>N(t.target.checked)}),e.jsx("span",{className:"text-sm",children:"Only my org"})]}),e.jsxs(Y,{onClick:ys,disabled:!r||ce,className:"bg-emerald-600 hover:bg-emerald-700 text-white flex items-center gap-2 disabled:opacity-50",children:[e.jsx(ye,{className:"w-4 h-4"}),"Assign Org to Accounts"]}),e.jsxs(Y,{onClick:()=>ae("userAccount"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add User Account"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Org"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:E==null?void 0:E.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t==null?void 0:t.full_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t==null?void 0:t.email}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${(t==null?void 0:t.role)==="admin"?"bg-red-100 text-red-800":"bg-blue-100 text-blue-800"}`,children:t==null?void 0:t.role})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t==null?void 0:t.department}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t!=null&&t.org_id?String(t==null?void 0:t.org_id).slice(0,8):"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t!=null&&t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t!=null&&t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae("userAccount",t),className:"text-blue-600 hover:text-blue-900",children:e.jsx($e,{className:"w-4 h-4"})}),r&&(t==null?void 0:t.org_id)!==r&&e.jsx("button",{title:"Attach to my org",onClick:()=>Et(t==null?void 0:t.id),className:"text-emerald-600 hover:text-emerald-800",disabled:ce,children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Re("user_profiles",t==null?void 0:t.id,"userAccount"),disabled:ke===(t==null?void 0:t.id),className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]},t==null?void 0:t.id))})]})}),(E==null?void 0:E.length)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No user accounts found. Click "Add User Account" to create one.'}),G?e.jsx("div",{className:"mt-3 p-3 rounded bg-blue-50 text-blue-700",children:G}):null]}),As=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Staff Records (",(B==null?void 0:B.length)||0,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-blue-600 appearance-auto",checked:j,onChange:t=>N(t.target.checked)}),e.jsx("span",{className:"text-sm",children:"Only my org"})]}),e.jsxs(Y,{onClick:ps,disabled:!r||ce,className:"bg-emerald-600 hover:bg-emerald-700 text-white flex items-center gap-2 disabled:opacity-50",children:[e.jsx(ye,{className:"w-4 h-4"}),"Assign Org to Staff"]}),e.jsxs(Y,{onClick:()=>ae("staff"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add Staff Member"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Department"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Org"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:B==null?void 0:B.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t==null?void 0:t.full_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${(t==null?void 0:t.department)==="Sales Consultants"?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"}`,children:t==null?void 0:t.department})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.phone)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.email)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t!=null&&t.org_id?String(t==null?void 0:t.org_id).slice(0,8):"—"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t!=null&&t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t!=null&&t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae("staff",t),className:"text-blue-600 hover:text-blue-900",children:e.jsx($e,{className:"w-4 h-4"})}),r&&(t==null?void 0:t.org_id)!==r&&e.jsx("button",{title:"Attach to my org",onClick:()=>Et(t==null?void 0:t.id),className:"text-emerald-600 hover:text-emerald-800",disabled:ce,children:e.jsx(ye,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Re("user_profiles",t==null?void 0:t.id,"staff"),disabled:ke===(t==null?void 0:t.id),className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]},t==null?void 0:t.id))})]})}),(B==null?void 0:B.length)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No staff records found. Click "Add Staff Member" to create one.'}),k?e.jsx("div",{className:"mt-3 p-3 rounded bg-blue-50 text-blue-700",children:k}):null]}),ks=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Vendors (",(H==null?void 0:H.length)||0,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-blue-600 appearance-auto",checked:j,onChange:t=>N(t.target.checked)}),e.jsx("span",{className:"text-sm",children:"Only my org"})]}),e.jsxs(Y,{onClick:ws,disabled:!r||ce,className:"bg-emerald-600 hover:bg-emerald-700 text-white flex items-center gap-2 disabled:opacity-50",children:[e.jsx(ye,{className:"w-4 h-4"}),"Assign Org to Vendors"]}),e.jsxs(Y,{onClick:()=>ae("vendor"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add Vendor"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact Person"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Specialty"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Rating"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:H==null?void 0:H.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t==null?void 0:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.contact_person)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.phone)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.specialty)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t!=null&&t.rating?`${t==null?void 0:t.rating}/5`:"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t!=null&&t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t!=null&&t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae("vendor",t),className:"text-blue-600 hover:text-blue-900",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Re("vendors",t==null?void 0:t.id),disabled:ke===(t==null?void 0:t.id),className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]},t==null?void 0:t.id))})]})}),(H==null?void 0:H.length)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No vendors found. Click "Add Vendor" to create one.'}),T?e.jsx("div",{className:"mt-3 p-3 rounded bg-blue-50 text-blue-700",children:T}):null]}),Ts=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Aftermarket Products (",(W==null?void 0:W.length)||0,")"]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"inline-flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",className:"h-4 w-4 accent-blue-600 appearance-auto",checked:j,onChange:t=>N(t.target.checked)}),e.jsx("span",{className:"text-sm",children:"Only my org"})]}),e.jsxs(Y,{onClick:bs,disabled:!r||ce,className:"bg-emerald-600 hover:bg-emerald-700 text-white flex items-center gap-2 disabled:opacity-50",children:[e.jsx(ye,{className:"w-4 h-4"}),"Assign Org to Products"]}),e.jsxs(Y,{onClick:()=>ae("product"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add Product"]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Brand"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Op Code"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cost"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Unit Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:W==null?void 0:W.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t==null?void 0:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.brand)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(t==null?void 0:t.category)||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-mono bg-gray-100 text-gray-800 rounded",children:(t==null?void 0:t.op_code)||"N/A"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",(t==null?void 0:t.cost)||"0.00"]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:["$",(t==null?void 0:t.unit_price)||"0.00"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t!=null&&t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t!=null&&t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae("product",t),className:"text-blue-600 hover:text-blue-900",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Re("products",t==null?void 0:t.id),disabled:ke===(t==null?void 0:t.id),className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]},t==null?void 0:t.id))})]})}),(W==null?void 0:W.length)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No products found. Click "Add Product" to create one.'}),S?e.jsx("div",{className:"mt-3 p-3 rounded bg-blue-50 text-blue-700",children:S}):null]}),Ms=()=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["SMS Templates (",(Z==null?void 0:Z.length)||0,")"]}),e.jsxs(Y,{onClick:()=>ae("template"),className:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2",children:[e.jsx(Ue,{className:"w-4 h-4"}),"Add Template"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Message Preview"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Z==null?void 0:Z.map(t=>{var g;return e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t==null?void 0:t.name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:(g=t==null?void 0:t.template_type)==null?void 0:g.replace("_"," ")})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-500 max-w-xs truncate",children:t==null?void 0:t.message_template}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${t!=null&&t.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:t!=null&&t.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>ae("template",t),className:"text-blue-600 hover:text-blue-900",children:e.jsx($e,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>Re("sms_templates",t==null?void 0:t.id),disabled:ke===(t==null?void 0:t.id),className:"text-red-600 hover:text-red-900 disabled:opacity-50",children:e.jsx(qe,{className:"w-4 h-4"})})]})})]},t==null?void 0:t.id)})})]})}),(Z==null?void 0:Z.length)===0&&e.jsx("div",{className:"text-center py-8 text-gray-500",children:'No SMS templates found. Click "Add Template" to create one.'})]}),Ps=()=>{var g;const t=`${(g=window==null?void 0:window.location)==null?void 0:g.origin}/guest-claims-submission-form`;return e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"QR Code Generator"}),e.jsx("p",{className:"text-gray-600",children:"Generate QR codes for easy access to your guest claims form and other important links."})]}),e.jsx("div",{children:e.jsx(Rr,{url:t,title:"Guest Claims Submission Form",description:"Generate a QR code for customers to quickly access your guest claims form. Perfect for printing on business cards, flyers, or displaying in your shop.",size:250,showControls:!0})}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"How to Use QR Codes:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 text-sm text-blue-800",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2",children:"📱 For Customers:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Open camera app on smartphone"}),e.jsx("li",{children:"• Point camera at QR code"}),e.jsx("li",{children:"• Tap notification to open claims form"}),e.jsx("li",{children:"• No app download required"})]})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium mb-2",children:"🖨️ For Your Business:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Download and print QR codes"}),e.jsx("li",{children:"• Add to business cards"}),e.jsx("li",{children:"• Display in waiting areas"}),e.jsx("li",{children:"• Include in email signatures"})]})]})]})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-3",children:"QR Code Benefits:"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"95%"}),e.jsx("div",{className:"text-gray-600",children:"Smartphone QR Support"})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"3x"}),e.jsx("div",{className:"text-gray-600",children:"Faster Than Typing URLs"})]}),e.jsxs("div",{className:"text-center p-4 bg-white rounded-lg",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"100%"}),e.jsx("div",{className:"text-gray-600",children:"Contactless Access"})]})]})]})]})},Rs=()=>{var g;if(!ms)return null;const t=()=>{switch(re){case"userAccount":return I?"Edit User Account":"Add User Account";case"staff":return I?"Edit Staff Member":"Add Staff Member";case"vendor":return I?"Edit Vendor":"Add Vendor";case"product":return I?"Edit Product":"Add Product";case"template":return I?"Edit SMS Template":"Add SMS Template";default:return"Form"}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold",children:t()}),e.jsx("button",{onClick:()=>Oe(!1),className:"text-gray-400 hover:text-gray-600",children:"×"})]}),e.jsxs("form",{onSubmit:Ns,className:"space-y-4",children:[re==="userAccount"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{label:"Full Name",value:f==null?void 0:f.full_name,onChange:a=>{var c;return fe({...f,full_name:(c=a==null?void 0:a.target)==null?void 0:c.value})},required:!0}),e.jsx(K,{label:"Email",type:"email",value:f==null?void 0:f.email,onChange:a=>{var c;return fe({...f,email:(c=a==null?void 0:a.target)==null?void 0:c.value})},required:!0}),!I&&e.jsx(K,{label:"Password",type:"password",value:f==null?void 0:f.password,onChange:a=>{var c;return fe({...f,password:(c=a==null?void 0:a.target)==null?void 0:c.value})},required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Role"}),e.jsx("select",{value:f==null?void 0:f.role,onChange:a=>{var c;return fe({...f,role:(c=a==null?void 0:a.target)==null?void 0:c.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:st==null?void 0:st.map(a=>e.jsx("option",{value:a==null?void 0:a.value,children:a==null?void 0:a.label},a==null?void 0:a.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsxs("select",{value:f==null?void 0:f.department,onChange:a=>{var c;return fe({...f,department:(c=a==null?void 0:a.target)==null?void 0:c.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select Department"}),rt==null?void 0:rt.map(a=>e.jsx("option",{value:a==null?void 0:a.value,children:a==null?void 0:a.label},a==null?void 0:a.value))]})]}),e.jsx(K,{label:"Phone",value:f==null?void 0:f.phone,onChange:a=>{var c;return fe({...f,phone:(c=a==null?void 0:a.target)==null?void 0:c.value})}})]}),re==="staff"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{label:"Full Name",value:q==null?void 0:q.full_name,onChange:a=>{var c;return Te({...q,full_name:(c=a==null?void 0:a.target)==null?void 0:c.value})},required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsxs("select",{value:q==null?void 0:q.department,onChange:a=>{var c;return Te({...q,department:(c=a==null?void 0:a.target)==null?void 0:c.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:[e.jsx("option",{value:"",children:"Select Department"}),nt==null?void 0:nt.map(a=>e.jsx("option",{value:a==null?void 0:a.value,children:a==null?void 0:a.label},a==null?void 0:a.value))]})]}),e.jsx(K,{label:"Phone",value:q==null?void 0:q.phone,onChange:a=>{var c;return Te({...q,phone:(c=a==null?void 0:a.target)==null?void 0:c.value})}}),e.jsx(K,{label:"Email",type:"email",value:q==null?void 0:q.email,onChange:a=>{var c;return Te({...q,email:(c=a==null?void 0:a.target)==null?void 0:c.value})}})]}),re==="vendor"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{label:"Vendor Name",value:A==null?void 0:A.name,onChange:a=>{var c;return pe({...A,name:(c=a==null?void 0:a.target)==null?void 0:c.value})},required:!0}),e.jsx(K,{label:"Contact Person",value:A==null?void 0:A.contact_person,onChange:a=>{var c;return pe({...A,contact_person:(c=a==null?void 0:a.target)==null?void 0:c.value})}}),e.jsx(K,{label:"Phone",value:A==null?void 0:A.phone,onChange:a=>{var c;return pe({...A,phone:(c=a==null?void 0:a.target)==null?void 0:c.value})}}),e.jsx(K,{label:"Email",type:"email",value:A==null?void 0:A.email,onChange:a=>{var c;return pe({...A,email:(c=a==null?void 0:a.target)==null?void 0:c.value})}}),e.jsx(K,{label:"Specialty",value:A==null?void 0:A.specialty,onChange:a=>{var c;return pe({...A,specialty:(c=a==null?void 0:a.target)==null?void 0:c.value})}}),e.jsx(K,{label:"Rating (1-5)",type:"number",min:"1",max:"5",step:"0.1",value:A==null?void 0:A.rating,onChange:a=>{var c;return pe({...A,rating:(c=a==null?void 0:a.target)==null?void 0:c.value})}})]}),re==="product"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{label:"Product Name",value:w==null?void 0:w.name,onChange:a=>{var c;return ie({...w,name:(c=a==null?void 0:a.target)==null?void 0:c.value})},required:!0}),e.jsx(K,{label:"Brand",value:w==null?void 0:w.brand,onChange:a=>{var c;return ie({...w,brand:(c=a==null?void 0:a.target)==null?void 0:c.value})}}),e.jsx(K,{label:"Category",value:w==null?void 0:w.category,onChange:a=>{var c;return ie({...w,category:(c=a==null?void 0:a.target)==null?void 0:c.value})}}),e.jsx(K,{label:"Op Code",value:w==null?void 0:w.op_code,onChange:a=>{var c;return ie({...w,op_code:(c=a==null?void 0:a.target)==null?void 0:c.value})},placeholder:"e.g., EN3, EN5"}),e.jsx(K,{label:"Cost",type:"number",step:"0.01",value:w==null?void 0:w.cost,onChange:a=>{var c;return ie({...w,cost:(c=a==null?void 0:a.target)==null?void 0:c.value})},required:!0}),e.jsx(K,{label:"Unit Price",type:"number",step:"0.01",value:w==null?void 0:w.unit_price,onChange:a=>{var c;return ie({...w,unit_price:(c=a==null?void 0:a.target)==null?void 0:c.value})},required:!0}),e.jsx(K,{label:"Part Number",value:w==null?void 0:w.part_number,onChange:a=>{var c;return ie({...w,part_number:(c=a==null?void 0:a.target)==null?void 0:c.value})}}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:w==null?void 0:w.description,onChange:a=>{var c;return ie({...w,description:(c=a==null?void 0:a.target)==null?void 0:c.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:"3"})]})]}),re==="template"&&e.jsxs(e.Fragment,{children:[e.jsx(K,{label:"Template Name",value:Q==null?void 0:Q.name,onChange:a=>{var c;return Ge({...Q,name:(c=a==null?void 0:a.target)==null?void 0:c.value})},required:!0}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Template Type"}),e.jsx("select",{value:Q==null?void 0:Q.template_type,onChange:a=>{var c;return Ge({...Q,template_type:(c=a==null?void 0:a.target)==null?void 0:c.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",required:!0,children:at==null?void 0:at.map(a=>e.jsx("option",{value:a==null?void 0:a.value,children:a==null?void 0:a.label},a==null?void 0:a.value))})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["Message Template (",((g=Q==null?void 0:Q.message_template)==null?void 0:g.length)||0,"/160)"]}),e.jsx("textarea",{value:Q==null?void 0:Q.message_template,onChange:a=>{var c;return Ge({...Q,message_template:(c=a==null?void 0:a.target)==null?void 0:c.value})},className:"w-full px-3 py-2 border border-gray-300 rounded-md",rows:"4",maxLength:"160",placeholder:"Use {{stock_number}}, {{vehicle_info}}, {{status}} as variables",required:!0})]})]}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(Y,{type:"button",onClick:()=>Oe(!1),className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200",children:"Cancel"}),e.jsx(Y,{type:"submit",disabled:ce,className:"px-4 py-2 bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50",children:ce?"Saving...":I?"Update":"Create"})]})]})]})})};return d?e.jsx(it,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Loading admin panel..."})]})})}):p?e.jsx(it,{children:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsx("div",{className:"max-w-md w-full bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Zt,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-2",children:"Admin Panel Error"}),e.jsx("p",{className:"text-gray-600 mb-6",children:p}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(Y,{onClick:()=>{var t;return(t=window.location)==null?void 0:t.reload()},className:"w-full bg-blue-600 hover:bg-blue-700 text-white flex items-center justify-center gap-2",children:[e.jsx($s,{className:"w-4 h-4"}),"Refresh Page"]}),e.jsx(Y,{onClick:fs,className:"w-full bg-gray-600 hover:bg-gray-700 text-white",children:"Debug Connection"}),e.jsx(Y,{onClick:()=>window.location.href="/authentication-portal",className:"w-full bg-green-600 hover:bg-green-700 text-white",children:"Go to Login"})]}),(x==null?void 0:x.showDebug)&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-100 rounded-lg text-left text-sm",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Debug Information:"}),e.jsxs("div",{className:"space-y-1 font-mono text-xs",children:[e.jsxs("div",{children:["Auth User: ",((At=x==null?void 0:x.authUser)==null?void 0:At.email)||"None"]}),e.jsxs("div",{children:["User ID: ",((kt=x==null?void 0:x.authUser)==null?void 0:kt.id)||"None"]}),e.jsxs("div",{children:["Profile Found: ",x!=null&&x.userProfile?"Yes":"No"]}),e.jsxs("div",{children:["User Role: ",((Tt=x==null?void 0:x.userProfile)==null?void 0:Tt.role)||"None"]}),e.jsxs("div",{children:["Department: ",((Mt=x==null?void 0:x.userProfile)==null?void 0:Mt.department)||"None"]}),(x==null?void 0:x.profileLoadError)&&e.jsxs("div",{className:"text-red-600 mt-2",children:["Error: ",(Pt=x==null?void 0:x.profileLoadError)==null?void 0:Pt.message]})]})]})]})})})}):e.jsx(it,{children:e.jsxs("div",{className:"min-h-screen bg-gray-50 pt-20",children:[e.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Admin Panel"}),e.jsx("p",{className:"text-gray-600",children:"Complete administrative management for Priority Automotive Tracker"}),e.jsxs("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-semibold text-blue-900 mb-2",children:"System Status"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-2 text-xs",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Auth Status:"}),e.jsx("span",{className:`ml-1 ${s?"text-green-600":"text-orange-600"}`,children:s?"Authenticated":"Demo Mode"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"User Role:"}),e.jsx("span",{className:"ml-1 text-blue-600",children:(n==null?void 0:n.role)||"Admin"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Access Level:"}),e.jsx("span",{className:"ml-1 text-green-600",children:"Full Access"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Database:"}),e.jsx("span",{className:"ml-1 text-green-600",children:"Connected"})]})]})]})]}),e.jsxs("div",{className:"mb-8 p-4 bg-white border border-gray-200 rounded-lg",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-3",children:"Current Data Status"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"User Accounts:"}),e.jsxs("span",{className:`ml-1 ${(E==null?void 0:E.length)>0?"text-green-600":"text-red-600"}`,children:[(E==null?void 0:E.length)||0," found"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Staff Records:"}),e.jsxs("span",{className:`ml-1 ${(B==null?void 0:B.length)>0?"text-green-600":"text-red-600"}`,children:[(B==null?void 0:B.length)||0," found"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Vendors:"}),e.jsxs("span",{className:`ml-1 ${(H==null?void 0:H.length)>0?"text-green-600":"text-red-600"}`,children:[(H==null?void 0:H.length)||0," found"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Products:"}),e.jsxs("span",{className:`ml-1 ${(W==null?void 0:W.length)>0?"text-green-600":"text-red-600"}`,children:[(W==null?void 0:W.length)||0," found"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"SMS Templates:"}),e.jsxs("span",{className:`ml-1 ${(Z==null?void 0:Z.length)>0?"text-green-600":"text-red-600"}`,children:[(Z==null?void 0:Z.length)||0," found"]})]})]})]}),e.jsx("div",{className:"mb-8",children:e.jsx("nav",{className:"flex space-x-8 border-b border-gray-200",children:tt==null?void 0:tt.map(t=>{const g=t==null?void 0:t.icon;let a=0;return(t==null?void 0:t.id)==="userAccounts"&&(a=(E==null?void 0:E.length)||0),(t==null?void 0:t.id)==="staffRecords"&&(a=(B==null?void 0:B.length)||0),(t==null?void 0:t.id)==="vendors"&&(a=(H==null?void 0:H.length)||0),(t==null?void 0:t.id)==="products"&&(a=(W==null?void 0:W.length)||0),(t==null?void 0:t.id)==="smsTemplates"&&(a=(Z==null?void 0:Z.length)||0),(t==null?void 0:t.id)==="qrCodes"&&(a=null),e.jsxs("button",{onClick:()=>b(t==null?void 0:t.id),className:`flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm ${u===(t==null?void 0:t.id)?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:[e.jsx(g,{className:"w-5 h-5"}),t==null?void 0:t.label,a!==null&&e.jsx("span",{className:`ml-1 px-2 py-1 text-xs rounded-full ${a>0?"bg-green-100 text-green-800":"bg-gray-100 text-gray-500"}`,children:a})]},t==null?void 0:t.id)})})}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[u==="userAccounts"&&Es(),u==="staffRecords"&&As(),u==="vendors"&&ks(),u==="products"&&Ts(),u==="smsTemplates"&&Ms(),u==="qrCodes"&&Ps()]})]}),Rs()]})})};export{zr as default};
//# sourceMappingURL=index-DpGX4s_g.js.map
