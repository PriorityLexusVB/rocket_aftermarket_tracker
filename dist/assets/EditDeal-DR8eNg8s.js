import{j as t}from"./index-BGF1l2ee.js";import{r}from"./react-Czq5O75u.js";import g from"./DealForm-zmdypWqJ.js";import{getDeal as i,mapDbDealToForm as l,updateDeal as j}from"./dealService-BQd5Kxso.js";import{c as N,a as D}from"./router-CZES1Sa0.js";import"./supabase-D02rA7zj.js";import"./tenantService-3FDy9hat.js";import"./options-CllavUpK.js";import"./useTenant-B0XQmU_v.js";import"./useLogger-BjAS5qgT.js";function P(){var d;const{id:s}=N(),u=D(),[a,n]=r.useState(null),[p,x]=r.useState(!0),[f,c]=r.useState(!1);r.useEffect(()=>{let o=!0;return(async()=>{try{const e=await i(s);if(o){const m=l?l(e):e;n(m)}}catch(e){alert((e==null?void 0:e.message)||"Failed to load deal")}finally{o&&x(!1)}})(),()=>{o=!1}},[s]);async function h(o){c(!0);try{await j(s,o);const e=await i(s),m=l?l(e):e;n(m)}catch(e){alert((e==null?void 0:e.message)||"Failed to save deal")}finally{c(!1)}}if(p)return t.jsx("div",{className:"max-w-5xl mx-auto p-8",children:"Loading..."});const b=(a==null?void 0:a.job_number)||`#${s}`,v=((d=a==null?void 0:a.vehicle)==null?void 0:d.stock_number)||(a==null?void 0:a.stock_number)||"â€”";return t.jsxs("div",{className:"max-w-5xl mx-auto p-4 md:p-8",children:[t.jsx("header",{className:"mb-4",children:t.jsxs("h1",{className:"text-xl font-semibold",children:["Deal ",b," / Stock # ",v]})}),t.jsxs("div",{className:"mb-6",children:[t.jsx("h1",{className:"text-2xl font-semibold",children:"Edit Deal"}),t.jsx("p",{className:"text-gray-600",children:"Update details and save."})]}),t.jsx(g,{mode:"edit",initial:a,onSave:h,onCancel:()=>u("/deals"),saving:f})]})}export{P as default};
//# sourceMappingURL=EditDeal-DR8eNg8s.js.map
